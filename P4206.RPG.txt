     H/TITLE P4206     - Billing Instructions - Page One                        
     H* ----------------------------------------------------------------        
     H*                                                                         
     H*    Copyright (c) 1985,1991,1994                                         
     H*    J. D. Edwards & Company                                              
     H*                                                                         
     H*        This unpublished material is proprietary to                      
     H*        J. D. Edwards & Company.  All rights reserved.                   
     H*        The methods and techniques described herein are                  
     H*        considered trade secrets and/or confidential.                    
     H*        Reproduction or distribution, in whole or in part,               
     H*        is forbidden except by express written permission                
     H*        of J. D. Edwards & Company.                                      
     H*                                                                         
     H* ----------------------------------------------------------------        
     H*                                                                         
     F*                                                                         
     F*    PROGRAM REVISION LOG                                                 
     F*    --------------------                                                 
     F*                                                                         
     F*          Date     Programmer     Nature of Revision                     
     F*        --------   ----------  ----------------------------------        
     F*        03/10/89   TISDALE     SAR # 00081091         (S/38 A/G)         
     F*        04/24/89   DMC         SAR # 93307                               
     F*        08/15/89   TISDALE     SAR # 00132193                            
     F*        08/25/89   MCH         SAR # 00136039                            
     F*        08/29/89   GSY         SAR # 00135941,00148072                   
     F*        03/29/90   MPP         SAR # 201005                              
     F*        04/10/90   MPP         SAR # 194909                              
     F*        06/08/90   BA          SAR # 00237999                            
     F*        06/13/90   MPP         SAR # 227774                              
     F*        09/06/90   CONROY      SAR # 259784                              
     F*        09/13/90   DMF         SAR # 259645                              
     F*        11/14/90   TC          SAR # 296083                              
     F*        06/07/91   MPP         SAR # 360866                              
     F*        09/05/91   TC          SAR # 40414243                            
     F*        11/20/91   MPP         SAR # 415880                              
     F*        12/11/91   MPP         SAR # 424161                              
     F*        02/12/92   LJD         SAR # 439970                              
     F*        02/25/92   CONROY      SAR # 451055                              
     F*        03/10/92   CONROY      SAR # 450571                              
     F*        04/30/92   LJD         SAR # 439961                              
     F*        11/19/92   MORGAN      SAR # 546249       (A6)                   
     F*        12/10/92   MORGAN      SAR # 550055       (A6)                   
     F*        02/12/93   MORGAN      SAR # 550056                              
     F*        05/03/93   MORGAN      SAR # 608825                              
     F*        05/14/93   MORGAN      SAR # 622395                              
     F*        09/02/93   KIRKWOOD    SAR # 651743                              
     F*        11/19/93   LJS         SAR # 685118                              
     F*        12/22/93   LJS         SAR # 656608                              
     F*        02/23/94   MPP         SAR # 718629                              
     F*        03/07/94   TC          SAR # 727023                              
     F*        05/11/94   LJS         SAR # 737803,756115,746865                
     F*        05/13/94   DLN         SAR # 751824                              
     F*        08/29/94   LJS         SAR # 784263                              
     F*        09/15/94   LJS         SAR # 738443                              
     F*        03/11/96   MORGAN      SAR # 1061383                             
     F*        03/15/96   MINO        SAR # 1164171                             
     F*                                                                         
     F*    Clone II logic class: MAINT00001                                     
     F*    --------------------------------                                     
     F*    Standard add, change, delete and inquiry video program               
     F*    logic.                                                               
     F*                                                                         
     F*****************************************************************         
      *--------------------------------------------------------------*          
      *           Modifications                                      *          
      *--------------------------------------------------------------*          
      * S10002826 10/05/99  M Daniels                                *          
      *           ---------------------------------------------------*          
      *           Added fields SI04 and SI05 in order to indicate    *          
      *           customer needs a  COA - certificate of analysis    *          
      *           or COC - certificate of compliance printed as an   *          
      *           item on all pickslips                              *          
      *                                                              *          
      * S10004004 02/18/02  J Corder                                 *          
      *           ---------------------------------------------------*          
      *           Added field BLFR to indicate billing frequency     *          
      *                                                              *          
      * S10006195 12/04/02  J Corder                                 *          
      *           ---------------------------------------------------*          
      *           Added field URCD to indicate confirm by particular *          
      *           method                                             *          
      *                                                              *          
      * S10007332 03/31/04  J Corder                                 *          
      *           ---------------------------------------------------*          
      *           Added field SI02 to indicate whether customer wants*          
      *           to be supplied an MSDS sheet                       *          
      *                                                              *          
      * S10007441 05/04/04  J Corder                                 *          
      *           ---------------------------------------------------*          
      *           Added field SI03 to indicate whether customer needs*          
      *           a commercial invoice                               *          
      *                                                              *          
14329 * S10014329 Aug 2006 M.Sesler                                  *          
      *           ---------------------------------------------------*          
      *           Added day of month to correspond with billing      *          
      *           type flag. Days available restricted to 1-28.      *          
      *           Used field A5URDT for day of month. Field is 6,0   *          
      *           but we are only using 2.                           *          
      *           Users are not limited to how often or when they    *          
      *           can change the day of the month.                   *          
      *                                                              *          
      * ccUS25783 04/16/08  M. Daniels                               *          
      *           ---------------------------------------------------*          
      *           Changed the edit for the day-of-month to allow     *          
      *           1 through 31.                                      *          
      *                                                                         
      * CC27089 05.11.2009 Charlie McLean                                       
      *         Removed comercial invoice using A5SI03 on S7441.                
      *                                                                         
      * CC27512 09.21.2009 Charlie McLean                                       
      *         Added A5SI03 as email flag for PDF invoice                      
      *                                                                         
      * WORF11044 12/16/10  M Daniels                                *          
      *           ---------------------------------------------------*          
      *           Implemented functionality for day-of-month  "P"    *          
      *           for VMI Consolidated billing.                      *          
      *                                                              *          
      * W11097  01.06.2011 Charlie McLean                                       
      *         Turned on VDEDII in video for WERCs MSDS delivery               
      *         preference. Recompile of P4206 required.                        
      *                                                                         
      *--------------------------------------------------------------*          
      *                                                                         
     FV4206   CF  E                    WORKSTN      KINFDS SRVFDS               
S6195FF0005   IF  E           K        DISK                                     
14329FF0006   IF  E           K        DISK                                     
     F*****************************************************************         
     F*                                                                         
     F*    Copy Member for Composite Common Subroutine - C0001                  
     F*                                                                         
     F/COPY JDECPY,D0001                                                        
     E*****************************************************************         
     E*    PROGRAM TABLES AND ARRAYS                                            
     E*    -------------------------                                            
     E*                                                                         
     E                    EMK        64  4               Error Msg              
     E                    @MK        64  1               Error Msg              
     E                    @ER        64  4               Error Msg              
     E*****************************************************************         
     E*                                                                         
     E*    Copy Member for Composite Common Subroutine - C0001                  
     E*                                                                         
     E/COPY JDECPY,E0001                                                        
     E*****************************************************************         
     E*                                                                         
     E*    Copy Member for Composite Common Subroutine - C0012                  
     E*                                                                         
     E/COPY JDECPY,E0012                                                        
     I*****************************************************************         
     E*                                                                         
     E*    Copy Member for Composite Common Subroutine - C997                   
     E*                                                                         
     E/COPY JDECPY,E997                                                         
     E*                                                                         
     E*    Copy Common Subroutine - Double Byte Truncation                      
     E*                                                                         
     E/COPY JDECPY,E9822                                                        
     I*****************************************************************         
     I*    PROGRAM INPUT SPECIFICATIONS AND DATA STRUCTURES                     
     I*    ------------------------------------------------                     
     I*                                                                         
     I*    Data Structure to Load Video Screen Text                             
     I*                                                                         
     IDSTXT       DS                                                            
     I                                        1  22 VTX001                      
     I                                       41  62 VTX002                      
     I                                       81 120 VTX003                      
     I                                      121 142 VTX004                      
     I                                      161 182 VTX005                      
     I                                      201 224 VTX006                      
     I                                      241 248 VTX007                      
     I                                      281 302 VTX008                      
     I                                      321 342 VTX009                      
     I                                      361 382 VTX010                      
     I                                      401 422 VTX011                      
     I                                      441 462 VTX012                      
     I                                      481 504 VTX013                      
     I                                      521 542 VTX014                      
     I                                      561 584 VTX015                      
     I                                      601 624 VTX016                      
     I                                      641 664 VTX017                      
     I                                      681 704 VTX018                      
     I                                      721 744 VTX019                      
     I                                      761 800 VTX020                      
     I                                      801 822 VTX021                      
     I                                      841 862 VTX022                      
     I                                      881 902 VTX023                      
     I                                      921 944 VTX024                      
     I                                      9611000 VTX025                      
     I                                     10011022 VTX026                      
     I                                     10411062 VTX027                      
S2826I***                                  10811120 VTX028                      
S2826I                                     10811090 VTX028                      
S2826I***                                  11211140 VTX029                      
S2826I                                     11211130 VTX029                      
     I                                     11611172 VTX030                      
     I                                     12011211 VTX031                      
     I                                     12411251 VTX032                      
     I                                     12811302 VTX033                      
     I                                     13211325 VTX034                      
     I                                     13611400 VTX035                      
     I                                     14011440 VTX036                      
     I                                     14411480 VTX037                      
     I                                     14811520 VTX038                      
     I                                     15211560 VTX039                      
     I                                     15611584 VTX040                      
     I                                     16011624 VTX041                      
     I                                     16411680 VTX042                      
     I                                     16811702 VTX043                      
     I                                     17211744 VTX044                      
     I                                     17611800 VTX045                      
     I/COPY JDECPY,I00DSINX                                                     
     I/COPY JDECPY,I00DSPROG                                                    
     I/COPY JDECPY,I00SC                                                        
     I/COPY JDECPY,I9800E                                                       
     I/COPY JDECPY,I00XFSRV                                                     
     I/COPY JDECPY,I010171                                                      
     I/COPY JDECPY,I030171                                                      
     I/COPY JDECPY,I7300                                                        
     I/COPY JDECPY,I0005U                                                       
     I/COPY JDECPY,I00PS@@                                                      
     I****************************************************************          
     IDS4009    E DSF4009                                                       
     C****************************************************************          
     C*    MAINLINE PROGRAM                                                     
     C*    ----------------                                                     
     C*                                                                         
     C*    Process housekeeping.                                                
     C*                                                                         
     C                     EXSR S999                                            
     C*                    ---- ----                                            
     C*                                                                         
     C*    If LR on, end program.                                               
     C*                                                                         
     C           *INLR     CABEQ'1'       EOJ                                   
     C*                    -----          ---                                   
     C*                                                                         
     C*    If automatic inquiry set, process inquiry.                           
     C*                                                                         
B1   C           $AUTO     CASEQ'1'       S003           24                     
     C*                    -----          ----                                  
E1   C                     ENDCS                                                
     C*                                                                         
     C*    Begin normal program processing.                                     
     C*    --------------------------------                                     
     C*                                                                         
B1   C           *INLR     DOWEQ'0'                                             
     C*                                                                         
     C*    Write video screen.                                                  
     C*                                                                         
     C                     WRITEV42061                                          
     C                     MOVE '1'       @@AID                                 
     C                     EXSR S001                                            
     C*                    ---- ----                                            
     C*                                                                         
     C*    Load data field dictionary parameters (one cycle only).              
     C*                                                                         
B2   C           $998      CASEQ' '       S998                                  
     C*                    -----          ----                                  
E2   C                     ENDCS                                                
     C*                                                                         
     C*    Begin video screen read processing.                                  
     C*                                                                         
     C                     SETOF                     999301                     
     C                     READ V4206                  9998                     
     C*                                                                         
     C*    Reset cursor position control fields                                 
     C*                                                                         
     C                     Z-ADD0         ##RROW                                
     C                     Z-ADD0         ##RCOL                                
     C*                                                                         
     C*    If video read timed out, end program.                                
     C*                                                                         
     C           *IN99     CABEQ'1'       EOJ            LR                     
     C*                    -----          ---                                   
     C           @@AID     CABEQ#FEOJ     EOJ            LR                     
     C*                    -----          ---                                   
     C*                                                                         
     C*    If valid command key pressed, process and return.                    
     C*                                                                         
B2   C           *IN15     IFEQ '1'                                             
     C                     EXSR S00EX                                           
     C*                    ---- -----                                           
     C           *INLR     CABEQ'1'       EOJ                                   
     C*                    -----          ---                                   
     C           *IN15     CABEQ'1'       END                                   
     C*                    -----          ---                                   
     C           *IN93     CABEQ'1'       END                                   
     C*                    -----          ---                                   
E2   C                     ENDIF                                                
     C*                                                                         
     C*    Edit the action code.                                                
     C*                                                                         
     C                     EXSR C0001                                           
     C*                    ---- -----                                           
     C*                                                                         
     C*    If end of job requested, end program.                                
     C*                                                                         
     C           *INLR     CABEQ'1'       EOJ                                   
     C*                    -----          ---                                   
     C*                                                                         
     C*    If clear screen requested, process and return.                       
     C*                                                                         
B2   C           @@AID     IFEQ #FCLR                                           
     C                     EXSR S001                                            
     C*                    ---- ----                                            
     C                     GOTO END                                             
     C*                    ---- ---                                             
E2   C                     ENDIF                                                
     C*                                                                         
     C*    Check for valid record key.                                          
     C*                                                                         
     C                     EXSR S003                                            
     C*                    ---- ----                                            
     C*                                                                         
     C*    If add or change, validate all video input.                          
     C*                                                                         
     C                     EXSR S005                                            
     C*                    ---- ----                                            
     C*                                                                         
     C*    Load default values for remaining Billing Instruction fields.        
     C*                                                                         
B2   C           *IN93     CASEQ'0'       S005A                                 
     C*                    -----          -----                                 
E2   C                     ENDCS                                                
     C*                                                                         
     C*    If add, change or delete, update file.                               
     C*                                                                         
B2   C           *IN93     IFEQ '0'                                             
B3   C           *IN24     CASEQ'0'       S010                                  
     C*                    -----          ----                                  
E3   C                     ENDCS                                                
E2   C                     ENDIF                                                
     C*                                                                         
     C*    Return for next input.                                               
     C*                                                                         
     C           END       TAG                                                  
     C*          ---       ---                                                  
     C*                                                                         
     C*    Set correct message in line 24.                                      
     C*                                                                         
B2   C           *IN93     IFEQ '1'                                             
     C                     MOVELSVL24E    VDL24                                 
X2   C                     ELSE                                                 
     C                     MOVELSVL24M    VDL24                                 
E2   C                     ENDIF                                                
E1   C                     ENDDO                                                
     C           EOJ       TAG                                                  
     C*          ---       ---                                                  
     C*                                                                         
     C*    END MAINLINE PROGRAM                                                 
     C*    --------------------                                                 
     C*****************************************************************         
     C*                                                                         
     C*    Copy Common Subroutine - Edit Action Code                            
     C*                                                                         
     C/COPY JDECPY,C0001                                                        
     C*****************************************************************         
     C*                                                                         
     C*    SUBROUTINE S00EX - Process Command Key Functions                     
     C*    ------------------------------------------------                     
     C*                                                                         
     C*    Processing:  1.  Determine command key pressed.                      
     C*                 2.  Process command key request.                        
     C*                                                                         
     CSR         S00EX     BEGSR                                                
     C*          -----     -----                                                
     C*                                                                         
     CSR         T00EXA    TAG                                                  
     C*          ------    ---                                                  
     C*                                                                         
     C*    If EOJ requested, exit subroutine.                                   
     C*                                                                         
     CSR         @@AID     CABEQ#FEOJ     ENDEXE         LR                     
     C*                    -----          ------                                
     C*                                                                         
     C*    If cursor sensitive, exit to cursor sensitive help.                  
     C*                                                                         
B1   CSR         @@AID     IFEQ #FQMRK                                          
     C*    If cursor sensitive, exit to cursor sensitive help.                  
     C*                                                                         
     CSR                   MOVEA*IN       ##IN                                  
     CSR                   CALL 'X96CCX'               98                       
     C*                    ---- --------                                        
     CSR                   PARM           I00SC                                 
     CSR                   PARM           SRVFDS                                
     CSR                   PARM           I00CSR                                
     CSR                   PARM 'CL'      ##CCFF  2                             
     CSR                   PARM           I00MDE                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDAN8R'                                        
     CSR                   MOVEL*BLANKS   ##DTAI                                
     CSR                   MOVEL'#N8R'    ##DTAI                                
E3   CSR                   ENDIF                                                
     C*                                                                         
     C*                                                                         
     CSR                   MOVEA*IN       ##IN                                  
     CSR                   CALL 'X96CCX'               98                       
     C*                    ---- --------                                        
     CSR                   PARM           I00SC                                 
     CSR                   PARM           SRVFDS                                
     CSR                   PARM           I00CSR                                
     CSR                   PARM '  '      ##CCFF  2                             
     CSR                   PARM           I00MDE                                
     C*                                                                         
B2   CSR         ##FLDN    IFNE *BLANKS                                         
     CSR                   EXSR S00VL                                           
     C*                    ---- -----                                           
     CSR                   MOVEA##IN      *IN,1                                 
E2   CSR                   ENDIF                                                
     CSR                   MOVEL*BLANKS   ##DTAI                                
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    If CMD 7 pressed, exit to error messages and return.                 
     C*    ----------------------------------------------------                 
     C*                                                                         
B1   CSR         @@AID     IFEQ #FERRD                                          
     CSR                   Z-ADD1         #G                                    
     CSR                   Z-ADD1         #H                                    
B2   CSR         #G        DOWLE64                                              
B3   CSR         @MK,#G    IFEQ '1'                                             
     CSR                   MOVE EMK,#G    @ER,#H                                
     CSR                   ADD  1         #H                                    
E3   CSR                   ENDIF                                                
     CSR                   ADD  1         #G                                    
E2   CSR                   ENDDO                                                
     CSR                   CALL 'P0000E'               98                       
     C*                    ---- --------                                        
     CSR                   PARM           @ER                                   
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    If HELP key pressed, exit to help facility and return.               
     C*    ------------------------------------------------------               
     C*                                                                         
B1   CSR         @@AID     IFEQ #FHELP                                          
     CSR                   CALL 'P00HELP'              98                       
     C*                    ---- --------                                        
     CSR                   PARM           HS@@                                  
     CSR                   PARM           HE@@                                  
     CSR                   PARM           I00SC                                 
     CSR                   PARM           SRVFDS                                
     CSR                   PARM           I00CSR                                
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    If CMD 20 pressed, clear screen and return.                          
     C*    -------------------------------------------                          
     C*                                                                         
B1   CSR         @@AID     IFEQ #FCLR                                           
     CSR                   EXSR S001                                            
     C*                    ---- ----                                            
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    If Command Key 09 pressed, Name Search                               
     C*    ------------------------------------------------------------         
     C*                                                                         
B1   CSR         @@AID     IFEQ #FNS                                            
     CSR                   CALL 'P01NS   '             98                       
     C*                    ---- ----------                                      
     CSR                   PARM           $$ALPH 40                             
     CSR                   PARM           $$AN8   8                             
     CSR                   PARM           PSDTE   4                             
     C*                                                                         
B2   CSR         $$AN8     IFNE *BLANKS                                         
     CSR                   MOVEL$$AN8     VDAN8                                 
E2   CSR                   ENDIF                                                
     C*                                                                         
     C*    Monitor for recursive program call                                   
     C*                                                                         
B2   CSR         *IN98     IFEQ '1'                                             
     CSR                   CALL 'J98RC'                98                       
     C*                    ---- -------                                         
     CSR                   PARM           $ERTST  1                             
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   SETON                     LR                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
     C*                                                                         
     C*    Monitor for returned record key and description.                     
     C*                                                                         
B2   CSR         *INU5     IFEQ '1'                                             
     CSR                   CALL 'J98RTVKY'             81                       
     C*                    ---- ----------                                      
     CSR                   PARM           $$RTKY 10                             
     CSR                   PARM           $$RTDS 40                             
     CSR                   MOVEL$$RTKY    $$RTKY                                
     CSR                   MOVEL$$RTDS    $$RTDS                                
E2   CSR                   ENDIF                                                
     C*                                                                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Process roll up and down keys.                                       
     C*    ------------------------------                                       
     C*                                                                         
B1   CSR         @@AID     IFEQ #FROLU                                          
     CSR         @@AID     OREQ #FROLD                                          
     CSR                   MOVE 'I'       @@PACT  1                             
B2   CSR         $SECUR    DOUEQ' '                                             
     CSR                   MOVE ' '       $SECUR  1                             
     C*                                                                         
     C*    If ROLL UP key pressed, process read next.                           
     C*    ------------------------------------------                           
     C*                                                                         
B3   CSR         @@AID     IFEQ #FROLU                                          
     C*                                                                         
     C*    Reset error indicators if roll                                       
     C*                                                                         
     CSR                   MOVEA$RESET    *IN,41                                
     CSR                   MOVE '0'       *IN,40                                
     CSR                   SETOF                     818299                     
     C*                                                                         
     CSR                   MOVEL'A71     '@@FMT                                 
     CSR                   MOVE 'K'       @@ACCS                                
     CSR                   MOVEL'READ    '@@OPER                                
     CSR                   MOVE 'Y'       @@LOCK                                
     CSR                   MOVE 'N'       @@CHGR                                
     CSR                   MOVEL'A5KY00  '@@KLST                                
     CSR                   Z-ADD1         @@KNUM                                
     CSR                   CALL 'XF0301'               99                       
     C*                    ---- --------                                        
     CSR                   PARM           PS@@1                                 
     CSR                   PARM           I0301                                 
     C*                                                                         
B4   CSR         @@IOR     IFEQ 'RL'                                            
     CSR         @@IOR     OREQ 'EOF'                                           
     CSR                   SETON                     81                         
E4   CSR                   ENDIF                                                
     C*                                                                         
B4   CSR         *IN81     IFEQ '1'                                             
     C*                                                                         
     CSR                   MOVEL'A71     '@@FMT                                 
     CSR                   MOVE 'K'       @@ACCS                                
     CSR                   MOVEL'SETLV   '@@OPER                                
     CSR                   MOVE 'N'       @@LOCK                                
     CSR                   MOVE 'N'       @@CHGR                                
     CSR                   MOVEL'A5KY00  '@@KLST                                
     CSR                   Z-ADD1         @@KNUM                                
     CSR                   CALL 'XF0301'               99                       
     C*                    ---- --------                                        
     CSR                   PARM           PS@@1                                 
     CSR                   PARM           I0301                                 
     C*                                                                         
     CSR                   SETOF                     8299                       
     C*                                                                         
     CSR                   MOVEL'A71     '@@FMT                                 
     CSR                   MOVE 'K'       @@ACCS                                
     CSR                   MOVEL'READ    '@@OPER                                
     CSR                   MOVE 'Y'       @@LOCK                                
     CSR                   MOVE 'N'       @@CHGR                                
     CSR                   MOVEL'A5KY00  '@@KLST                                
     CSR                   Z-ADD1         @@KNUM                                
     CSR                   CALL 'XF0301'               99                       
     C*                    ---- --------                                        
     CSR                   PARM           PS@@1                                 
     CSR                   PARM           I0301                                 
     C*                                                                         
B5   CSR         @@IOR     IFEQ 'RL'                                            
     CSR         @@IOR     OREQ 'EOF'                                           
     CSR                   SETON                     82                         
E5   CSR                   ENDIF                                                
     C*                                                                         
     C*    If error on read, set error.                                         
     C*                                                                         
B5   CSR         *IN82     IFEQ '1'                                             
     CSR                   SETON                     9341                       
     CSR                   MOVE '1'       @MK,2                                 
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E5   CSR                   ENDIF                                                
E4   CSR                   ENDIF                                                
E3   CSR                   ENDIF                                                
     C*                                                                         
     C*    If ROLL DOWN key pressed, process read prior.                        
     C*    ---------------------------------------------                        
     C*                                                                         
B3   CSR         @@AID     IFEQ #FROLD                                          
     C*                                                                         
     C*    Reset error indicators if roll                                       
     C*                                                                         
     CSR                   MOVEA$RESET    *IN,41                                
     CSR                   MOVE '0'       *IN,40                                
     CSR                   SETOF                     818299                     
     C*                                                                         
     CSR                   MOVEL'A71     '@@FMT                                 
     CSR                   MOVE 'K'       @@ACCS                                
     CSR                   MOVEL'READP   '@@OPER                                
     CSR                   MOVE 'Y'       @@LOCK                                
     CSR                   MOVE 'N'       @@CHGR                                
     CSR                   MOVEL'A5KY00  '@@KLST                                
     CSR                   Z-ADD1         @@KNUM                                
     CSR                   CALL 'XF0301'               99                       
     C*                    ---- --------                                        
     CSR                   PARM           PS@@1                                 
     CSR                   PARM           I0301                                 
     C*                                                                         
B4   CSR         @@IOR     IFEQ 'RL'                                            
     CSR         @@IOR     OREQ 'BOF'                                           
     CSR                   SETON                     81                         
E4   CSR                   ENDIF                                                
     C*                                                                         
B4   CSR         *IN81     IFEQ '1'                                             
     C*                                                                         
     CSR                   MOVEL'A71     '@@FMT                                 
     CSR                   MOVE 'K'       @@ACCS                                
     CSR                   MOVEL'SETHV   '@@OPER                                
     CSR                   MOVE 'N'       @@LOCK                                
     CSR                   MOVE 'N'       @@CHGR                                
     CSR                   MOVEL'A5KY00  '@@KLST                                
     CSR                   Z-ADD1         @@KNUM                                
     CSR                   CALL 'XF0301'               99                       
     C*                    ---- --------                                        
     CSR                   PARM           PS@@1                                 
     CSR                   PARM           I0301                                 
     C*                                                                         
     CSR                   SETOF                     8299                       
     C*                                                                         
     CSR                   MOVEL'A71     '@@FMT                                 
     CSR                   MOVE 'K'       @@ACCS                                
     CSR                   MOVEL'READP   '@@OPER                                
     CSR                   MOVE 'Y'       @@LOCK                                
     CSR                   MOVE 'N'       @@CHGR                                
     CSR                   MOVEL'A5KY00  '@@KLST                                
     CSR                   Z-ADD1         @@KNUM                                
     CSR                   CALL 'XF0301'               99                       
     C*                    ---- --------                                        
     CSR                   PARM           PS@@1                                 
     CSR                   PARM           I0301                                 
     C*                                                                         
B5   CSR         @@IOR     IFEQ 'RL'                                            
     CSR         @@IOR     OREQ 'BOF'                                           
     CSR                   SETON                     82                         
E5   CSR                   ENDIF                                                
     C*                                                                         
     C*    If error on read, set error.                                         
     C*                                                                         
B5   CSR         *IN82     IFEQ '1'                                             
     CSR                   SETON                     9341                       
     CSR                   MOVE '1'       @MK,2                                 
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E5   CSR                   ENDIF                                                
E4   CSR                   ENDIF                                                
E3   CSR                   ENDIF                                                
     C*                                                                         
     C*    Load video screen data on roll keys.                                 
     C*    ------------------------------------                                 
     C*                                                                         
B3   CSR         @@AID     IFEQ #FROLU                                          
     CSR         @@AID     OREQ #FROLD                                          
B4   CSR         $SECUR    CASEQ' '       S004                                  
     C*                    -----          ----                                  
E4   CSR                   ENDCS                                                
     C*                                                                         
E3   CSR                   ENDIF                                                
     C*                                                                         
E2   CSR                   ENDDO                                                
     C*                                                                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    If Function Key 01 pressed, Second Page                              
     C*    ---------------------------------------                              
     C*                                                                         
B1   CSR         @@AID     IFEQ #F01                                            
     CSR                   MOVE VDAN8     PSAN8                                 
     CSR                   CALL 'P42061  '             98                       
     C*                    ---- ----------                                      
     CSR                   PARM           PSAN8                                 
     C*                                                                         
     C*    Monitor for recursive program call                                   
     C*                                                                         
B2   CSR         *IN98     IFEQ '1'                                             
     CSR                   CALL 'J98RC'                98                       
     C*                    ---- -------                                         
     CSR                   PARM           $ERTST  1                             
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   SETON                     LR                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
     C*                                                                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    If Command Key 08 pressed, Related Address Numbers                   
     C*    --------------------------------------------------                   
     C*                                                                         
B1   CSR         @@AID     IFEQ #F02                                            
     CSR                   MOVE VDAN8     PSAN8   8                             
     CSR                   CALL 'P40REL  '             98                       
     C*                    ---- ----------                                      
     CSR                   PARM           PSAN8                                 
     C*                                                                         
     C*    Monitor for recursive program call                                   
     C*                                                                         
B2   CSR         *IN98     IFEQ '1'                                             
     CSR                   CALL 'J98RC'                98                       
     C*                    ---- -------                                         
     CSR                   PARM           $ERTST  1                             
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   SETON                     LR                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
     C*                                                                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    If Command Key 13 pressed, Print Messages                            
     C*    -----------------------------------------                            
     C*                                                                         
B1   CSR         @@AID     IFEQ #F03                                            
     CSR                   MOVEL'P4016   '$$PID                                 
     CSR                   MOVEL'ZJDE0001'$$VERS 10                             
     CSR                   CALL 'P4016   '             98                       
     C*                    ---- ----------                                      
     CSR                   PARM           $$PID  10                             
     CSR                   PARM           $$VERS 10                             
     C*                                                                         
     C*    Monitor for recursive program call                                   
     C*                                                                         
B2   CSR         *IN98     IFEQ '1'                                             
     CSR                   CALL 'J98RC'                98                       
     C*                    ---- -------                                         
     CSR                   PARM           $ERTST  1                             
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   SETON                     LR                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
     C*                                                                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    To display valid EDI transaction sets, call P40131                   
     C*    --------------------------------------------------                   
     C*                                                                         
B1   CSR         @@AID     IFEQ #F04                                            
     CSR                   MOVE 'B'       PSFRMT                                
     CSR                   MOVE 'TS'      PSXRTC                                
     CSR                   MOVE VDAN8     PSAN8                                 
     CSR                   CALL 'P40131  '             98                       
     C*                    ---- ----------                                      
     CSR                   PARM           PSAN8                                 
     CSR                   PARM           PSFRMT  1                             
     CSR                   PARM           PSXRTC  2                             
     C*                                                                         
     C*    Monitor for recursive program call                                   
     C*                                                                         
B2   CSR         *IN98     IFEQ '1'                                             
     CSR                   CALL 'J98RC'                98                       
     C*                    ---- -------                                         
     CSR                   PARM           $ERTST  1                             
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   SETON                     LR                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
     C*                                                                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    If Command Key 14 pressed, Customer Group Def.                       
     C*    ----------------------------------------------                       
     C*                                                                         
B1   CSR         @@AID     IFEQ #F06                                            
     C*                                                                         
     CSR                   MOVEL'P4092   '$$PID                                 
     CSR                   MOVEL'ZJDE0002'$$VERS                                
     CSR                   CALL 'P4092   '             98                       
     C*                    ---- ----------                                      
     CSR                   PARM           $$PID                                 
     CSR                   PARM           $$VERS                                
     CSR                   PARM VDCPGP    $$CPGP  8                             
     C*                                                                         
     C*    Monitor for recursive program call                                   
     C*                                                                         
B2   CSR         *IN98     IFEQ '1'                                             
     CSR                   CALL 'J98RC'                98                       
     C*                    ---- -------                                         
     CSR                   PARM           $ERTST  1                             
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   SETON                     LR                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
     C*                                                                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    If Command Key 10 pressed, Item Restrictions                         
     C*    --------------------------------------------                         
     C*                                                                         
B1   CSR         @@AID     IFEQ #F05                                            
     C*                                                                         
     CSR                   MOVE VDAN8     PSAN8                                 
     CSR                   CALL 'P40132  '             98                       
     C*                    ---- ----------                                      
     CSR                   PARM           PSAN8                                 
     CSR                   PARM           PSEDF2                                
     CSR                   PARM 'S'       PSSOP   1                             
     C*                                                                         
     C*    Monitor for recursive program call                                   
     C*                                                                         
B2   CSR         *IN98     IFEQ '1'                                             
     CSR                   CALL 'J98RC'                98                       
     C*                    ---- -------                                         
     CSR                   PARM           $ERTST  1                             
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   SETON                     LR                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
     C*                                                                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    If CMD 24 pressed...exit to show all command keys                    
     C*    ------------------------------------------------------------         
     C*                                                                         
B1   CSR         @@AID     IFEQ #FKEYS                                          
     CSR                   CALL 'P9601H '              98                       
     C*                    ---- --------                                        
     CSR                   PARM           I00SC                                 
     CSR                   PARM           SRVFDS                                
     CSR                   PARM           I00CSR                                
     CSR         @@AID     CABNE#FKEYS    T00EXA                                
     C*                    -----          ------                                
     C*                                                                         
     C*    Monitor for recursive program call                                   
     C*                                                                         
B2   CSR         *IN98     IFEQ '1'                                             
     CSR                   CALL 'J98RC'                98                       
     C*                    ---- -------                                         
     CSR                   PARM           $ERTST  1                             
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   SETON                     RT                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- ------                                          
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
     C*                                                                         
     CSR                   GOTO ENDEXE                                          
     C*                    ---- -----                                           
E1   CSR                   ENDIF                                                
     C*                                                                         
B1   CSR         @@AID     IFNE '1'                                             
     CSR                   SETON                     0193                       
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     CSR         ENDEXE    ENDSR                                                
     C*****************************************************************         
     C*                                                                         
     C*    SUBROUTINE S00VL - Cursor Control Return Values                      
     C*    -----------------------------------------------                      
     C*                                                                         
     C*    By format, find the field to update and move in the                  
     C*    returned value.  If the format is a subfile, the record              
     C*    to change is found in @@RRN.                                         
     C*                                                                         
     CSR         S00VL     BEGSR                                                
     C*          -----     -----                                                
     C*                                                                         
B1   CSR         ##RVAL    IFEQ '*BLANK'                                        
     CSR                   MOVE *BLANK    ##RVAL                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Return values for fields in format V42061                            
     C*                                                                         
B1   CSR         ##RFMT    IFEQ 'V42061  '                                      
B2   CSR         ##FLDN    IFEQ 'ACTION  '                                      
     CSR                   MOVEL##RVAL    ACTION                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDAN8   '                                      
     CSR                   MOVEL##RVAL    VDAN8                                 
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
     CSR                   ENDIF                                                
     C*                                                                         
     CSR         ##FLDN    IFEQ 'VDURCD  '                                      
     CSR                   MOVEL##RVAL    VDURCD                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
     CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDBADT  '                                      
     CSR                   MOVEL##RVAL    VDBADT                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDAN8R  '                                      
     CSR                   MOVEL##RVAL    VDAN8R                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDCPGP  '                                      
     CSR                   MOVEL##RVAL    VDCPGP                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDASN   '                                      
     CSR                   MOVEL##RVAL    VDASN                                 
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDTRDC  '                                      
     CSR                   MOVEL##RVAL    VDTRDC                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDARTO  '                                      
     CSR                   MOVEL##RVAL    VDARTO                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDMINO  '                                      
     CSR                   MOVEL##RVAL    VDMINO                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDMAXO  '                                      
     CSR                   MOVEL##RVAL    VDMAXO                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDEXHD  '                                      
     CSR                   MOVEL##RVAL    VDEXHD                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDINMG  '                                      
     CSR                   MOVEL##RVAL    VDINMG                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
     CSR         ##FLDN    IFEQ 'VDPORQ  '                                      
     CSR                   MOVEL##RVAL    VDPORQ                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
     CSR                   END                                                  
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDEDF1  '                                      
     CSR                   MOVEL##RVAL    VDEDF1                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDEDF2  '                                      
     CSR                   MOVEL##RVAL    VDEDF2                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDICON  '                                      
     CSR                   MOVEL##RVAL    VDICON                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDBACK  '                                      
     CSR                   MOVEL##RVAL    VDBACK                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDSBAL  '                                      
     CSR                   MOVEL##RVAL    VDSBAL                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDAPTS  '                                      
     CSR                   MOVEL##RVAL    VDAPTS                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDSI01  '                                      
     CSR                   MOVEL##RVAL    VDSI01                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDORTP  '                                      
     CSR                   MOVEL##RVAL    VDORTP                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDDEL1  '                                      
     CSR                   MOVEL##RVAL    VDDEL1                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDDEL2  '                                      
     CSR                   MOVEL##RVAL    VDDEL2                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDEDPM  '                                      
     CSR                   MOVEL##RVAL    VDEDPM                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDEDCI  '                                      
     CSR                   MOVEL##RVAL    VDEDCI                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDEDII  '                                      
     CSR                   MOVEL##RVAL    VDEDII                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDEDQD  '                                      
     CSR                   MOVEL##RVAL    VDEDQD                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
     C*                                                                         
B2   CSR         ##FLDN    IFEQ 'VDEDAD  '                                      
     CSR                   MOVEL##RVAL    VDEDAD                                
     CSR                   GOTO END0VL                                          
     C*                    ---- ------                                          
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*----------------------------------------------------------------         
     CSR         END0VL    ENDSR                                                
     C*****************************************************************         
     C*                                                                         
     C*    SUBROUTINE S001 - Clear Fields                                       
     C*    ------------------------------                                       
     C*                                                                         
     C*    Processing:  1.  Clear action code only if requested.                
     C*                 2.  Reset all video screen and data file fields         
     C*                     for next transaction.                               
     C*                                                                         
     CSR         S001      BEGSR                                                
     C*          ----      -----                                                
     C*                                                                         
     C*    Clear action code only if clear screen action.                       
     C*                                                                         
B1   CSR         @@AID     IFEQ #FCLR                                           
     CSR                   MOVE *ALL'0'   $RESET                                
     CSR                   MOVEA$RESET    *IN,41                                
     CSR                   MOVE ' '       ACTION  1                             
     CSR                   MOVE *ZERO     A5AN8                                 
     CSR                   MOVE *BLANK    VDAN8                                 
     CSR                   MOVE *BLANK    VDALPH                                
     CSR                   MOVE *BLANK    PSEDF2  1                             
     CSR                   CLEAR$ADD#                                           
E1   CSR                   ENDIF                                                
     C*                                                                         
     CSR                   Z-ADDA5AN8     $SAN8                                 
     CSR                   CLEARI0301                                           
     CSR                   Z-ADD$SAN8     A5AN8                                 
     C*                                                                         
     CSR                   MOVE *BLANK    VDAN8R                                
     CSR                   MOVE *BLANK    VDAPTS                                
     CSR                   MOVE *BLANK    VDPORQ                                
     CSR                   MOVE *BLANK    VDARTO                                
     CSR                   MOVE *BLANK    VDEDF1                                
     CSR                   MOVE *BLANK    VDEDF2                                
     CSR                   MOVE *BLANK    VDICON                                
     CSR                   MOVE *BLANK    VDBACK                                
     CSR                   MOVE *BLANK    VDBADT                                
     CSR                   MOVE *BLANK    VDCPGP                                
     CSR                   MOVE *BLANK    VDASN                                 
     CSR                   MOVE *BLANK    VDDEL1                                
     CSR                   MOVE *BLANK    VDDEL2                                
     CSR                   MOVE *BLANK    VDEXHD                                
     CSR                   MOVE *BLANK    VDINMG                                
     CSR                   MOVE *BLANK    VDMINO                                
     CSR                   MOVE *BLANK    VDSBAL                                
     CSR                   MOVE *BLANK    VDTRDC                                
     CSR                   MOVE *BLANK    VDMAXO                                
     CSR                   MOVE *BLANK    VDEDPM                                
     CSR                   MOVE *BLANK    VDEDCI                                
     CSR                   MOVE *BLANK    VDEDII                                
     CSR                   MOVE *BLANK    VDEDQD                                
     CSR                   MOVE *BLANK    VDEDAD                                
     CSR                   MOVE *BLANK    VDSI01                                
S7332CSR                   MOVE *BLANK    VDSI02                                
27512C                     MOVE *BLANK    VDSI03                                
S2826CSR                   MOVE *BLANK    VDSI04                                
S2826CSR                   MOVE *BLANK    VDSI05                                
S4004CSR                   MOVE *BLANK    VDBLFR                                
14329CSR                   MOVE *BLANK    VDURDT                                
S6195CSR                   MOVE *BLANK    VDURCD                                
S6195CSR                   MOVE *BLANK    VDTXT                                 
     CSR                   MOVE *BLANK    VDORTP                                
     CSR                   MOVELSVL24M    VDL24                                 
     CSR                   MOVE ' '       @IN37   1                             
     C*----------------------------------------------------------------         
     CSR         END001    ENDSR                                                
     C*****************************************************************         
     C*                                                                         
     C*    SUBROUTINE S003 - Edit Key                                           
     C*    --------------------------                                           
     C*                                                                         
     C*    Processing:  1.  Clear error indicators and arrays.                  
     C*                 2.  Load input keys.                                    
     C*                 3.  Validate master file key.                           
     C*                 4.  Release master file record lock.                    
     C*                 5.  Load video screen output on inquiry.                
     C*                                                                         
     CSR         S003      BEGSR                                                
     C*          ----      -----                                                
     C*                                                                         
     C*    Load data field dictionary parameters (one cycle only).              
     C*                                                                         
B1   CSR         $998      CASEQ' '       S998                                  
     C*                    -----          ----                                  
E1   CSR                   ENDCS                                                
     C*                                                                         
     C*    Reset error indicators and arrays.                                   
     C*                                                                         
     CSR                   MOVE *ALL'0'   $RESET 39                             
     CSR                   MOVE *BLANK    $REST1 63                             
     CSR                   MOVEA$RESET    *IN,41                                
     CSR                   MOVEA$REST1    @MK,2                                 
     CSR                   MOVE *BLANK    @ER                                   
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Load video input field for - Address Number                          
     C*                                                                         
     CSR                   MOVEAVDAN8     @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   Z-ADD#NUMR     $NBR08  80                            
     CSR                   MOVE $NBR08    A5AN8                                 
     C*                                                                         
     CSR                   Z-ADDA5AN8     ABAN8                                 
     CSR                   MOVE 'K'       @@ACCS                                
     CSR                   MOVEL'CHAIN   '@@OPER                                
     CSR                   MOVE 'N'       @@LOCK                                
     CSR                   MOVE 'N'       @@CHGR                                
     CSR                   MOVEL'ABKY01  '@@KLST                                
     CSR                   Z-ADD1         @@KNUM                                
     CSR                   CALL 'XF0101'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           PS@@1                                 
     CSR                   PARM           I0101                                 
     C*                                                                         
B1   CSR         *IN81     IFEQ '1'                                             
     CSR         @@IOR     ORNE *BLANK                                          
     CSR                   MOVE '1'       @MK,02                                
     CSR                   SETON                     4293                       
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     CSR                   SETOF                     98                         
     C*                                                                         
     CSR                   MOVEL'A71     '@@FMT                                 
     CSR                   MOVE 'K'       @@ACCS                                
     CSR                   MOVEL'CHAIN   '@@OPER                                
     CSR                   MOVE 'Y'       @@LOCK                                
     CSR                   MOVE 'N'       @@CHGR                                
     CSR                   MOVEL'A5KY00  '@@KLST                                
     CSR                   Z-ADD1         @@KNUM                                
     CSR                   CALL 'XF0301'               98                       
     C*                    ---- --------                                        
     CSR                   PARM           PS@@1                                 
     CSR                   PARM           I0301                                 
     C*                                                                         
B1   CSR         @@IOR     IFEQ 'NF'                                            
     CSR         @@IOR     OREQ 'RL'                                            
     CSR                   SETON                     98                         
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    If security violation, set error condition.                          
     C*                                                                         
B1   CSR         $$SECR    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,8                                 
     CSR                   SETON                     4293                       
     CSR                   MOVE ' '       $$SECR  1                             
     CSR                   GOTO END003                                          
     C*                    ---- ------                                          
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit result of read and action code.                                 
     C*                                                                         
B1   CSR         *IN98     IFEQ '1'                                             
     CSR         *IN21     COMP '0'                      41 *error*             
X1   CSR                   ELSE                                                 
     CSR         *IN21     COMP '1'                      41 *error*             
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Issue error message if attempting an add action from this            
     C*    program.  Use this logic instead of C0001 in order to issue          
     C*    a more meaningful message when F0301 record is not found.            
     C*                                                                         
B1   CSR         *IN21     IFEQ '1'                                             
     CSR         *IN98     ANDEQ'1'                                             
     CSR                   MOVE '1'       @MK,13                                
     CSR                   SETON                     4293                       
     CSR                   END                                                  
     C*                                                                         
     C*    If indicator 41 on, invalid key for action code.                     
     C*                                                                         
B1   CSR         *IN41     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,2                                 
     CSR                   SETON                     4293                       
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    If error on inquiry, reset previous action field.                    
     C*                                                                         
B1   CSR         *IN24     IFEQ '1'                                             
     CSR         *IN41     ANDEQ'1'                                             
     CSR                   MOVE ' '       @@PACT  1                             
     CSR                   END                                                  
     C*                                                                         
     C*    If indicator 99 on, record in use.                                   
     C*                                                                         
B1   CSR         *IN99     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,6                                 
     CSR                   SETON                     4293                       
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    If change or delete, inquiry required prior.                         
     C*                                                                         
B1   CSR         *IN22     IFEQ '1'                                             
     CSR         *IN23     OREQ '1'                                             
B2   CSR         $ADD#     IFNE $NBR08                                          
     CSR                   SETON                     4093                       
     CSR                   MOVE '1'       @MK,1                                 
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    If not inquiry, skip remainder of subroutine.                        
     C*                                                                         
     CSR         *IN24     CABEQ'0'       END003                                
     C*                    -----          ------                                
     C*                                                                         
     CSR                   Z-ADD$NBR08    $ADD#                                 
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    If errors, skip remainder of subroutine.                             
     C*                                                                         
     CSR         *IN93     CABEQ'1'       END003                                
     C*                    -----          ------                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move data base information to video screen.                          
     C*                                                                         
     CSR                   EXSR S004                                            
     C*                    ---- ----                                            
     C*----------------------------------------------------------------         
     CSR         END003    ENDSR                                                
     C*****************************************************************         
     C*                                                                         
     C*    Copy Common Subroutine - Right Justify Numeric Fields                
     C*                                                                         
     C/COPY JDECPY,C0012                                                        
     C*****************************************************************         
     C*                                                                         
     C*    SUBROUTINE S004 - Load Video Screen Data                             
     C*    ----------------------------------------                             
     C*                                                                         
     C*    Processing:  1.  Move data base information to video screen.         
     C*                     All video screen fields are alpha and               
     C*                     therefore numeric information must be               
     C*                     processed through subroutine C0014 to set           
     C*                     proper decimals and provide editing for             
     C*                     display on screen.                                  
     C*                                                                         
     C*                     Date fields must be converted from their            
     C*                     internal format of month, day and year or           
     C*                     julian to the system format using program           
     C*                     X0028.                                              
     C*                                                                         
     CSR         S004      BEGSR                                                
     C*          ----      -----                                                
     C*                                                                         
     C*    Release record lock on master file.                                  
     C*                                                                         
     CSR                   MOVEL'A71     '@@FMT                                 
     CSR                   MOVE 'K'       @@ACCS                                
     CSR                   MOVEL'UNLCK   '@@OPER                                
     CSR                   MOVE 'Y'       @@LOCK                                
     CSR                   MOVE 'N'       @@CHGR                                
     CSR                   MOVEL'A5KY00  '@@KLST                                
     CSR                   Z-ADD1         @@KNUM                                
     CSR                   CALL 'XF0301'               98                       
     C*                    ---- --------                                        
     CSR                   PARM           PS@@1                                 
     CSR                   PARM           I0301                                 
     C*                                                                         
     C*    Retrieve Address Number information.                                 
     C*                                                                         
     CSR                   Z-ADDA5AN8     ABAN8                                 
     CSR                   MOVE 'K'       @@ACCS                                
     CSR                   MOVEL'CHAIN   '@@OPER                                
     CSR                   MOVE 'N'       @@LOCK                                
     CSR                   MOVE 'N'       @@CHGR                                
     CSR                   MOVEL'ABKY01  '@@KLST                                
     CSR                   Z-ADD1         @@KNUM                                
     CSR                   CALL 'XF0101'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           PS@@1                                 
     CSR                   PARM           I0101                                 
B1   CSR         *IN81     IFEQ '1'                                             
     CSR         @@IOR     ORNE *BLANK                                          
     CSR                   MOVE '1'       @MK,02                                
     CSR                   MOVE *BLANKS   VDALPH                                
     CSR                   SETON                     4293                       
X1   CSR                   ELSE                                                 
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Name - Alpha                                        
     C*                                                                         
     CSR                   MOVELABALPH    VDALPH                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Address Number                                      
     C*                                                                         
     CSR                   MOVE *BLANK    #SINBR                                
     CSR                   MOVELA5AN8     #SINBR                                
     CSR                   MOVE T@AN8     #DTYP                                 
     CSR                   MOVE W@AN8     #EWRD                                 
     CSR                   MOVE E@AN8     #EC                                   
     CSR                   MOVE F@AN8     #DSPD                                 
     CSR                   MOVE G@AN8     #DATD                                 
     CSR                   MOVE J@AN8     #ALR                                  
     CSR                   MOVE ' '       #ECOR                                 
     CSR                   MOVE ' '       #DCOR                                 
     CSR                   EXSR C00161                                          
     C*                    ---- ------                                          
B1   CSR         #ALR      IFEQ 'L'                                             
     CSR                   MOVEL#SINBR    VDAN8                                 
X1   CSR                   ELSE                                                 
     CSR                   MOVE #SINBR    VDAN8                                 
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Related - Address Number                            
     C*                                                                         
     CSR         A5AN8R    IFNE 0                                               
     CSR                   MOVE A5AN8R    VDAN8R                                
     CSR                   END                                                  
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Allow partial order shipments                       
     C*                                                                         
     CSR                   MOVELA5SI01    VDSI01                                
S2826C*----------------------------------------------------------------         
S2826C*                                                                         
S2826C*    Move to output - COA Required                                        
S2826C*                                                                         
S2826CSR                   MOVELA5SI04    VDSI04                                
S7332CSR                   MOVELA5SI02    VDSI02                                
27512C                     MOVELA5SI03    VDSI03                                
S2826C*----------------------------------------------------------------         
S2826C*                                                                         
S2826C*    Move to output - COC Required                                        
S2826C*                                                                         
S2826CSR                   MOVELA5SI05    VDSI05                                
     C*                                                                         
S4004CSR                   MOVELA5BLFR    VDBLFR                                
14329C*----------------------------------------------------------------         
14329 *                                                                         
14329 *    Move to output - Day of Month for Billing                            
14329 *                                                                         
14329CSR                   MOVE A5URDT    VDURDT                                
     C*                                                                         
S6195CSR                   MOVELA5URCD    VDURCD                                
S6195CSR                   MOVEL'42'      SY01    4                             
S6195CSR                   MOVEL'CF'      RT01    2                             
S6195CSR                   MOVE VDURCD    KY01   10                             
     C*                                                                         
S6195CSR         KEY01     CHAINF0005                90                         
S6195CSR         *IN90     IFEQ *OFF                                            
S6195CSR                   MOVELDRDL01    VDTXT                                 
S6195CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*    Move to output - Partial Shipments Allowed (Y/N)                     
     C*                                                                         
     CSR                   MOVELA5APTS    VDAPTS                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Accounts Receivable (C/P/S)                         
     C*                                                                         
     CSR                   MOVELA5ARTO    VDARTO                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Customer PO Required (Y/N/ )                        
     C*                                                                         
     CSR                   MOVELA5PORQ    VDPORQ                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Delivery Notes (Y/N)                                
     C*                                                                         
     CSR                   MOVELA5EDF1    VDEDF1                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Item Restrictions                                   
     C*                                                                         
     CSR                   MOVELA5EDF2    VDEDF2                                
     CSR                   MOVELA5EDF2    PSEDF2                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Invoice Consolidation (Y/N)                         
     C*                                                                         
     CSR                   MOVELA5ICON    VDICON                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Backorders Allowed (Y/N)                            
     C*                                                                         
     CSR                   MOVELA5BACK    VDBACK                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Billing Address Type                                
     C*                                                                         
     CSR                   MOVELA5BADT    VDBADT                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Customer Pricing Rule                               
     C*                                                                         
     CSR                   MOVE *BLANK    #SINBR                                
     CSR                   MOVELA5CPGP    #SINBR                                
     CSR                   MOVE T@CPGP    #DTYP                                 
     CSR                   MOVE W@CPGP    #EWRD                                 
     CSR                   MOVE E@CPGP    #EC                                   
     CSR                   MOVE F@CPGP    #DSPD                                 
     CSR                   MOVE G@CPGP    #DATD                                 
     CSR                   MOVE J@CPGP    #ALR                                  
     CSR                   MOVE ' '       #ECOR                                 
     CSR                   MOVE ' '       #DCOR                                 
     CSR                   EXSR C00161                                          
     C*                    ---- ------                                          
B1   CSR         #ALR      IFEQ 'L'                                             
     CSR                   MOVEL#SINBR    VDCPGP                                
X1   CSR                   ELSE                                                 
     CSR                   MOVE #SINBR    VDCPGP                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Pricing Schedule Name                               
     C*                                                                         
     CSR                   MOVE *BLANK    #SINBR                                
     CSR                   MOVELA5ASN     #SINBR                                
     CSR                   MOVE T@ASN     #DTYP                                 
     CSR                   MOVE W@ASN     #EWRD                                 
     CSR                   MOVE E@ASN     #EC                                   
     CSR                   MOVE F@ASN     #DSPD                                 
     CSR                   MOVE G@ASN     #DATD                                 
     CSR                   MOVE J@ASN     #ALR                                  
     CSR                   MOVE ' '       #ECOR                                 
     CSR                   MOVE ' '       #DCOR                                 
     CSR                   EXSR C00161                                          
     C*                    ---- ------                                          
B1   CSR         #ALR      IFEQ 'L'                                             
     CSR                   MOVEL#SINBR    VDASN                                 
X1   CSR                   ELSE                                                 
     CSR                   MOVE #SINBR    VDASN                                 
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Delivery Instructions Line 1                        
     C*                                                                         
     CSR                   MOVELA5DEL1    VDDEL1                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Delivery Instructions Line 2                        
     C*                                                                         
     CSR                   MOVELA5DEL2    VDDEL2                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Credit Hold Exempt                                  
     C*                                                                         
     CSR                   MOVELA5EXHD    VDEXHD                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Print Message                                       
     C*                                                                         
     CSR                   MOVE *BLANK    #SINBR                                
     CSR                   MOVELA5INMG    #SINBR                                
     CSR                   MOVE T@INMG    #DTYP                                 
     CSR                   MOVE W@INMG    #EWRD                                 
     CSR                   MOVE E@INMG    #EC                                   
     CSR                   MOVE F@INMG    #DSPD                                 
     CSR                   MOVE G@INMG    #DATD                                 
     CSR                   MOVE J@INMG    #ALR                                  
     CSR                   MOVE ' '       #ECOR                                 
     CSR                   MOVE ' '       #DCOR                                 
     CSR                   EXSR C00161                                          
     C*                    ---- ------                                          
B1   CSR         #ALR      IFEQ 'L'                                             
     CSR                   MOVEL#SINBR    VDINMG                                
X1   CSR                   ELSE                                                 
     CSR                   MOVE #SINBR    VDINMG                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Minimum Order Value                                 
     C*                                                                         
     CSR                   MOVE *BLANK    #SINBR                                
     CSR                   MOVELA5MINO    #SINBR                                
     CSR                   MOVE T@MINO    #DTYP                                 
     CSR                   MOVE W@MINO    #EWRD                                 
     CSR                   MOVE E@MINO    #EC                                   
     CSR                   MOVE F@MINO    #DSPD                                 
     CSR                   MOVE G@MINO    #DATD                                 
     CSR                   MOVE J@MINO    #ALR                                  
     CSR                   MOVE ' '       #ECOR                                 
     CSR                   MOVE ' '       #DCOR                                 
     CSR                   EXSR C00161                                          
     C*                    ---- ------                                          
B1   CSR         #ALR      IFEQ 'L'                                             
     CSR                   MOVEL#SINBR    VDMINO                                
X1   CSR                   ELSE                                                 
     CSR                   MOVE #SINBR    VDMINO                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Substitutes Allowed (Y/N)                           
     C*                                                                         
     CSR                   MOVELA5SBAL    VDSBAL                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Discount - Trade                                    
     C*                                                                         
     CSR                   MOVE *BLANK    #SINBR                                
     CSR                   MOVELA5TRDC    #SINBR                                
     CSR                   MOVE T@TRDC    #DTYP                                 
     CSR                   MOVE W@TRDC    #EWRD                                 
     CSR                   MOVE E@TRDC    #EC                                   
     CSR                   MOVE F@TRDC    #DSPD                                 
     CSR                   MOVE G@TRDC    #DATD                                 
     CSR                   MOVE J@TRDC    #ALR                                  
     CSR                   MOVE ' '       #ECOR                                 
     CSR                   MOVE ' '       #DCOR                                 
     CSR                   EXSR C00161                                          
     C*                    ---- ------                                          
B1   CSR         #ALR      IFEQ 'L'                                             
     CSR                   MOVEL#SINBR    VDTRDC                                
X1   CSR                   ELSE                                                 
     CSR                   MOVE #SINBR    VDTRDC                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Maximum Order Value                                 
     C*                                                                         
     CSR                   MOVE *BLANK    #SINBR                                
     CSR                   MOVELA5MAXO    #SINBR                                
     CSR                   MOVE T@MAXO    #DTYP                                 
     CSR                   MOVE W@MAXO    #EWRD                                 
     CSR                   MOVE E@MAXO    #EC                                   
     CSR                   MOVE F@MAXO    #DSPD                                 
     CSR                   MOVE G@MAXO    #DATD                                 
     CSR                   MOVE J@MAXO    #ALR                                  
     CSR                   MOVE ' '       #ECOR                                 
     CSR                   MOVE ' '       #DCOR                                 
     CSR                   EXSR C00161                                          
     C*                    ---- ------                                          
B1   CSR         #ALR      IFEQ 'L'                                             
     CSR                   MOVEL#SINBR    VDMAXO                                
X1   CSR                   ELSE                                                 
     CSR                   MOVE #SINBR    VDMAXO                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Batch Processing Mode                               
     C*                                                                         
     CSR                   MOVELA5EDPM    VDEDPM                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Customer Type Identifier                            
     C*                                                                         
     CSR                   MOVELA5EDCI    VDEDCI                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Item Type Identifier                                
     C*                                                                         
     CSR                   MOVELA5EDII    VDEDII                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Order Template                                      
     C*                                                                         
     CSR                   MOVELA5ORTP    VDORTP                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Quantity Decimals                                   
     C*                                                                         
     CSR                   MOVE *BLANK    #SINBR                                
     CSR                   MOVELA5EDQD    #SINBR                                
     CSR                   MOVE T@EDQD    #DTYP                                 
     CSR                   MOVE W@EDQD    #EWRD                                 
     CSR                   MOVE E@EDQD    #EC                                   
     CSR                   MOVE F@EDQD    #DSPD                                 
     CSR                   MOVE G@EDQD    #DATD                                 
     CSR                   MOVE J@EDQD    #ALR                                  
     CSR                   MOVE ' '       #ECOR                                 
     CSR                   MOVE ' '       #DCOR                                 
     CSR                   EXSR C00161                                          
     C*                    ---- ------                                          
B1   CSR         #ALR      IFEQ 'L'                                             
     CSR                   MOVEL#SINBR    VDEDQD                                
X1   CSR                   ELSE                                                 
     CSR                   MOVE #SINBR    VDEDQD                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Move to output - Amount Decimals                                     
     C*                                                                         
     CSR                   MOVE *BLANK    #SINBR                                
     CSR                   MOVELA5EDAD    #SINBR                                
     CSR                   MOVE T@EDAD    #DTYP                                 
     CSR                   MOVE W@EDAD    #EWRD                                 
     CSR                   MOVE E@EDAD    #EC                                   
     CSR                   MOVE F@EDAD    #DSPD                                 
     CSR                   MOVE G@EDAD    #DATD                                 
     CSR                   MOVE J@EDAD    #ALR                                  
     CSR                   MOVE ' '       #ECOR                                 
     CSR                   MOVE ' '       #DCOR                                 
     CSR                   EXSR C00161                                          
     C*                    ---- ------                                          
B1   CSR         #ALR      IFEQ 'L'                                             
     CSR                   MOVEL#SINBR    VDEDAD                                
X1   CSR                   ELSE                                                 
     CSR                   MOVE #SINBR    VDEDAD                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     CSR         END004    ENDSR                                                
     C*****************************************************************         
     C*                                                                         
     C*    Copy Common Subroutine - Double Byte Truncation                      
     C*                                                                         
     C/COPY JDECPY,C9822                                                        
     C*****************************************************************         
     C*                                                                         
     C*    Copy Common Subroutine - Format Numeric Fields for Output with Overri
     C*                                                                         
     C/COPY JDECPY,C00161                                                       
     C*****************************************************************         
     C*                                                                         
     C*    SUBROUTINE S005  - Scrub Input                                       
     C*    ------------------------------                                       
     C*                                                                         
     C*    Processing:  1.  Validate all video input.                           
     C*                     All numeric fields must be processed                
     C*                     thru subroutines C0012 and C00151 in order          
     C*                     to scrub the alpha input field and convert          
     C*                     back to internal numeric representation of          
     C*                     15 digits and 0 decimals.                           
     C*                                                                         
     C*                     Date fields must be converted from system           
     C*                     format to their internal foramt of month,           
     C*                     day and year or julian using program X0028.         
     C*                 2.  Update data record fields from video.               
     C*                                                                         
     CSR         S005      BEGSR                                                
     C*          ----      -----                                                
     C*                                                                         
     C*    If not addition or change, bypass subroutine                         
     C*                                                                         
B1   CSR         *IN21     IFEQ '0'                                             
     CSR         *IN22     ANDEQ'0'                                             
     CSR                   GOTO END005                                          
     C*                    ---- ------                                          
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Scrub and edit - Address Number                                      
     C*                                                                         
     CSR                   MOVEAVDAN8     @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   Z-ADD#NUMR     A5AN8                                 
     C*                                                                         
     C*    Validate value for - Address Number                                  
     C*                                                                         
     CSR                   Z-ADDA5AN8     ABAN8                                 
     CSR                   MOVE 'K'       @@ACCS                                
     CSR                   MOVEL'CHAIN   '@@OPER                                
     CSR                   MOVE 'N'       @@LOCK                                
     CSR                   MOVE 'N'       @@CHGR                                
     CSR                   MOVEL'ABKY01  '@@KLST                                
     CSR                   Z-ADD1         @@KNUM                                
     CSR                   CALL 'XF0101'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           PS@@1                                 
     CSR                   PARM           I0101                                 
B1   CSR         *IN81     IFEQ '1'                                             
     CSR         @@IOR     ORNE *BLANK                                          
     CSR                   MOVE '1'       @MK,02                                
     CSR                   SETON                     4293                       
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Related - Address Number                            
     C*                                                                         
     CSR                   MOVEAVDAN8R    @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   Z-ADD#NUMR     A5AN8R                                
     C*                                                                         
     C*    Set default value - Factor Value - Numeric                           
     C*                                                                         
B4   CSR         VDAN8R    IFEQ *BLANK                                          
     CSR         D@AN8R    ANDNE*BLANK                                          
     CSR                   MOVEAD@AN8R    @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   MOVE F@AN8R    #DSPD                                 
     CSR                   MOVE G@AN8R    #DATD                                 
     CSR                   EXSR C00151                                          
     C*                    ---- ------                                          
     CSR                   MOVE #NUMBR    A5AN8R                                
E4   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Factor Value - Numeric                  
     C*                                                                         
B4   CSR         L@AN8R    IFNE *BLANK                                          
     CSR                   MOVE *BLANK    X@AN8R 15                             
     CSR                   MOVE '1'       $ERTST  1                             
     CSR                   MOVELA5AN8R    X@AN8R                                
B5   CSR         X@AN8R    IFGE L@AN8R                                          
     CSR         X@AN8R    ANDLEU@AN8R                                          
     CSR                   MOVE ' '       $ERTST                                
E5   CSR                   ENDIF                                                
B5   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     6093                       
E5   CSR                   ENDIF                                                
E4   CSR                   ENDIF                                                
     C*                                                                         
B1   CSR         A5AN8R    IFEQ *ZERO                                           
     CSR                   MOVE '1'       A5AN8R                                
     CSR                   MOVE A5AN8R    VDAN8R                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Related Addresses                     
     C*                                                                         
B1   CSR         VDAN8R    IFNE *BLANKS                                         
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVEL'40'      #USY                                  
     CSR                   MOVE 'RA'      #URT                                  
     CSR                   MOVE VDAN8R    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     6093                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Partial Shipments Allowed (Y/N)                     
     C*                                                                         
     CSR                   MOVELVDAPTS    A5APTS                                
     C*                                                                         
     C*    Set default value - Partial Shipments Allowed (Y/N)                  
     C*                                                                         
B1   CSR         A5APTS    IFEQ *BLANK                                          
B2   CSR         D@APTS    IFNE *BLANK                                          
     CSR                   MOVEAD@APTS    @40                                   
     CSR                   MOVEA@40       A5APTS                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5APTS                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Partial Shipments Allowed (Y/N)                
     C*                                                                         
B1   CSR         A@APTS    IFNE *BLANK                                          
     CSR                   MOVEAA@APTS    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                    ---- ----                                            
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5APTS    $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     6793                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Partial Shipments Allowed (Y/N)         
     C*                                                                         
B1   CSR         L@APTS    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         A5APTS    IFGE L@APTS                                          
B3   CSR         A5APTS    IFLE U@APTS                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     6793                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Partial Shipments Allowed (Y/N)       
     C*                                                                         
B1   CSR         R@APTS    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@APTS    #USY                                  
     CSR                   MOVE R@APTS    #URT                                  
     CSR                   MOVE A5APTS    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     6793                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Accounts Receivable (C/P/S)                         
     C*                                                                         
     CSR                   MOVELVDARTO    A5ARTO                                
     C*                                                                         
     C*    Set default value - Accounts Receivable (C/P/S)                      
     C*                                                                         
B1   CSR         A5ARTO    IFEQ *BLANK                                          
B2   CSR         D@ARTO    IFNE *BLANK                                          
     CSR                   MOVEAD@ARTO    @40                                   
     CSR                   MOVEA@40       A5ARTO                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5ARTO                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Accounts Receivable (C/P/S)                    
     C*                                                                         
B1   CSR         A@ARTO    IFNE *BLANK                                          
     CSR                   MOVEAA@ARTO    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                    ---- ----                                            
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5ARTO    $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     5393                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Accounts Receivable (C/P/S)             
     C*                                                                         
B1   CSR         L@ARTO    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         A5ARTO    IFGE L@ARTO                                          
B3   CSR         A5ARTO    IFLE U@ARTO                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     5393                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Accounts Receivable (C/P/S)           
     C*                                                                         
B1   CSR         R@ARTO    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@ARTO    #USY                                  
     CSR                   MOVE R@ARTO    #URT                                  
     CSR                   MOVE A5ARTO    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     5393                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Customer PO Required (Y/N/ )                        
     C*                                                                         
     CSR                   MOVELVDPORQ    A5PORQ                                
     C*                                                                         
     C*    Set default value - Customer PO Required (Y/N/ )                     
     C*                                                                         
     CSR         A5PORQ    IFEQ *BLANK                                          
     CSR         D@PORQ    IFNE *BLANK                                          
     CSR                   MOVEAD@PORQ    @40                                   
     CSR                   MOVEA@40       A5PORQ                                
     CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
     CSR         #M        DOWLE40                                              
     CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
     CSR                   END                                                  
     CSR                   ADD  1         #M                                    
     CSR                   END                                                  
     CSR                   MOVEA@40,2     A5PORQ                                
     CSR                   END                                                  
     CSR                   END                                                  
     CSR                   END                                                  
     C*                                                                         
     C*    Edit allowed values - Customer Po Required (Y/N/ )                   
     C*                                                                         
     CSR         A@PORQ    IFNE *BLANK                                          
     CSR                   MOVEAA@PORQ    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                    ---- ----                                            
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5PORQ    $WRK10                                
     CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
     CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
     CSR                   END                                                  
     CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     5793                       
     CSR                   END                                                  
     CSR                   END                                                  
     CSR                   END                                                  
     C*                                                                         
     C*    Edit upper and lower range - Customer PO Required (Y/N/ )            
     C*                                                                         
     CSR         L@PORQ    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
     CSR         A5PORQ    IFGE L@PORQ                                          
     CSR         A5PORQ    IFLE U@PORQ                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   END                                                  
     CSR                   END                                                  
     CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     5793                       
     CSR                   END                                                  
     CSR                   END                                                  
     C*                                                                         
     C*    Edit from descriptive titles - Customer Po Required (Y/N/ )          
     C*                                                                         
     CSR         R@PORQ    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@PORQ    #USY                                  
     CSR                   MOVE R@PORQ    #URT                                  
     CSR                   MOVE A5PORQ    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
     CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     5793                       
     CSR                   END                                                  
     CSR                   END                                                  
     C*----------------------------------------------------------------         
     C*    Scrub and edit - Delivery Notes (Y/N)                                
     C*                                                                         
     CSR                   MOVELVDEDF1    A5EDF1                                
     C*                                                                         
     C*    Set default value - Delivery Notes (Y/N)                             
     C*                                                                         
B1   CSR         A5EDF1    IFEQ *BLANK                                          
B2   CSR         D@EDF1    IFNE *BLANK                                          
     CSR                   MOVEAD@EDF1    @40                                   
     CSR                   MOVEA@40       A5EDF1                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5EDF1                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Delivery Notes (Y/N)                           
     C*                                                                         
B1   CSR         A@EDF1    IFNE *BLANK                                          
     CSR                   MOVEAA@EDF1    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                    ---- ----                                            
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5EDF1    $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     4693                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Delivery Notes (Y/N)                    
     C*                                                                         
B1   CSR         L@EDF1    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         A5EDF1    IFGE L@EDF1                                          
B3   CSR         A5EDF1    IFLE U@EDF1                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     4693                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Delivery Notes (Y/N)                  
     C*                                                                         
B1   CSR         R@EDF1    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@EDF1    #USY                                  
     CSR                   MOVE R@EDF1    #URT                                  
     CSR                   MOVE A5EDF1    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     4693                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Item Restrictions                                   
     C*                                                                         
     CSR                   MOVELVDEDF2    A5EDF2                                
     C*                                                                         
     C*    Set default value - Item Restrictions                                
     C*                                                                         
B1   CSR         A5EDF2    IFEQ *BLANK                                          
B2   CSR         D@EDF2    IFNE *BLANK                                          
     CSR                   MOVEAD@EDF2    @40                                   
     CSR                   MOVEA@40       A5EDF2                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5EDF2                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Item Restrictions                              
     C*                                                                         
B1   CSR         A@EDF2    IFNE *BLANK                                          
     CSR                   MOVEAA@EDF2    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                    ---- ----                                            
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5EDF2    $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     4793                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Item Restrictions                       
     C*                                                                         
B1   CSR         L@EDF2    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         A5EDF2    IFGE L@EDF2                                          
B3   CSR         A5EDF2    IFLE U@EDF2                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     4793                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Item Restrictions                     
     C*                                                                         
B1   CSR         R@EDF2    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@EDF2    #USY                                  
     CSR                   MOVE R@EDF2    #URT                                  
     CSR                   MOVE A5EDF2    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     4793                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Invoice Consolidation (Y/N)                         
     C*                                                                         
     CSR                   MOVELVDICON    A5ICON                                
     C*                                                                         
     C*    Set default value - Invoice Consolidation (Y/N)                      
     C*                                                                         
B1   CSR         A5ICON    IFEQ *BLANK                                          
B2   CSR         D@ICON    IFNE *BLANK                                          
     CSR                   MOVEAD@ICON    @40                                   
     CSR                   MOVEA@40       A5ICON                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5ICON                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Invoice Consolidation (Y/N)                    
     C*                                                                         
B1   CSR         A@ICON    IFNE *BLANK                                          
     CSR                   MOVEAA@ICON    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                    ---- ----                                            
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5ICON    $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     5293                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Invoice Consolidation (Y/N)             
     C*                                                                         
B1   CSR         L@ICON    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         A5ICON    IFGE L@ICON                                          
B3   CSR         A5ICON    IFLE U@ICON                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     4793                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Invoice Consolidation (Y/N)           
     C*                                                                         
B1   CSR         R@ICON    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@ICON    #USY                                  
     CSR                   MOVE R@ICON    #URT                                  
     CSR                   MOVE A5ICON    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     5293                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Backorders Allowed (Y/N)                            
     C*                                                                         
     CSR                   MOVELVDBACK    A5BACK                                
     C*                                                                         
     C*    Set default value - Backorders Allowed (Y/N)                         
     C*                                                                         
B1   CSR         A5BACK    IFEQ *BLANK                                          
B2   CSR         D@BACK    IFNE *BLANK                                          
     CSR                   MOVEAD@BACK    @40                                   
     CSR                   MOVEA@40       A5BACK                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5BACK                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Backorders Allowed (Y/N)                       
     C*                                                                         
B1   CSR         A@BACK    IFNE *BLANK                                          
     CSR                   MOVEAA@BACK    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                    ---- ----                                            
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5BACK    $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     5093                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Backorders Allowed (Y/N)                
     C*                                                                         
B1   CSR         L@BACK    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         A5BACK    IFGE L@BACK                                          
B3   CSR         A5BACK    IFLE U@BACK                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     5093                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Backorders Allowed (Y/N)              
     C*                                                                         
B1   CSR         R@BACK    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@BACK    #USY                                  
     CSR                   MOVE R@BACK    #URT                                  
     CSR                   MOVE A5BACK    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     5093                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Billing Address Type                                
     C*                                                                         
     CSR                   MOVELVDBADT    A5BADT                                
     C*                                                                         
     C*    Set default value - Billing Address Type                             
     C*                                                                         
B1   CSR         A5BADT    IFEQ *BLANK                                          
B2   CSR         D@BADT    IFNE *BLANK                                          
     CSR                   MOVEAD@BADT    @40                                   
     CSR                   MOVEA@40       A5BADT                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5BADT                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Billing Address Type                           
     C*                                                                         
B1   CSR         A@BADT    IFNE *BLANK                                          
     CSR                   MOVEAA@BADT    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                    ---- ----                                            
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5BADT    $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     5193                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Billing Address Type                    
     C*                                                                         
B1   CSR         L@BADT    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         A5BADT    IFGE L@BADT                                          
B3   CSR         A5BADT    IFLE U@BADT                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     5193                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Billing Address Type                  
     C*                                                                         
B1   CSR         R@BADT    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@BADT    #USY                                  
     CSR                   MOVE R@BADT    #URT                                  
     CSR                   MOVE A5BADT    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     5193                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Customer Pricing Rule                               
     C*                                                                         
     CSR                   MOVELVDCPGP    A5CPGP                                
     C*                                                                         
     C*    Set default value - Customer Pricing Rule                            
     C*                                                                         
B1   CSR         A5CPGP    IFEQ *BLANK                                          
B2   CSR         D@CPGP    IFNE *BLANK                                          
     CSR                   MOVEAD@CPGP    @40                                   
     CSR                   MOVEA@40       A5CPGP                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5CPGP                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Customer Pricing Rule                          
     C*                                                                         
B1   CSR         A@CPGP    IFNE *BLANK                                          
     CSR                   MOVEAA@CPGP    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                    ---- ----                                            
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5CPGP    $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     6693                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Customer Pricing Rule                   
     C*                                                                         
B1   CSR         L@CPGP    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         A5CPGP    IFGE L@CPGP                                          
B3   CSR         A5CPGP    IFLE U@CPGP                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     6693                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Customer Pricing Rule                 
     C*                                                                         
B1   CSR         R@CPGP    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@CPGP    #USY                                  
     CSR                   MOVE R@CPGP    #URT                                  
     CSR                   MOVE A5CPGP    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     6693                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     CSR         *IN26     IFEQ '1'                                             
     C*                                                                         
     C*    Scrub and edit - Pricing Schedule Name                               
     C*                                                                         
     CSR                   MOVELVDASN     $WK8    8                             
     C*                                                                         
     C*    Set default value - Pricing Schedule Name                            
     C*                                                                         
B1   CSR         $WK8      IFEQ *BLANK                                          
B2   CSR         D@ASN     IFNE *BLANK                                          
     CSR                   MOVEAD@ASN     @40                                   
     CSR                   MOVEA@40       $WK8                                  
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     $WK8                                  
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Pricing Schedule Name                          
     C*                                                                         
B1   CSR         A@ASN     IFNE *BLANK                                          
     CSR                   MOVEAA@ASN     @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                    ---- ----                                            
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVEL$WK8      $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     6293                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Pricing Schedule Name                   
     C*                                                                         
B1   CSR         L@ASN     IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         $WK8      IFGE L@ASN                                           
B3   CSR         $WK8      IFLE U@ASN                                           
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     6293                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Pricing Schedule Name                 
     C*                                                                         
B1   CSR         R@ASN     IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@ASN     #USY                                  
     CSR                   MOVE R@ASN     #URT                                  
     CSR                   MOVE $WK8      #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     6293                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     CSR                   MOVEL$WK8      A5ASN                                 
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Order Template                                      
     C*                                                                         
     CSR                   MOVELVDORTP    A5ORTP                                
     C*                                                                         
     C*    Edit from descriptive titles - Order Template                        
     C*                                                                         
B1   CSR         VDORTP    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@ORTP    #USY                                  
     CSR                   MOVE R@ORTP    #URT                                  
     CSR                   MOVE A5ORTP    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     5893                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Delivery Instructions Line 1                        
     C*                                                                         
     CSR                   MOVELVDDEL1    A5DEL1                                
     C*                                                                         
     C*    Edit allowed values - Delivery Instructions Line 1                   
     C*                                                                         
B1   CSR         A@DEL1    IFEQ '*NB'                                           
     CSR         A5DEL1    ANDEQ*BLANK                                          
     CSR                   MOVE '1'       @MK,03                                
     CSR                   SETON                     5993                       
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Delivery Instructions Line 2                        
     C*                                                                         
     CSR                   MOVELVDDEL2    A5DEL2                                
     C*                                                                         
     C*    Edit allowed values - Delivery Instructions Line 2                   
     C*                                                                         
B1   CSR         A@DEL2    IFEQ '*NB'                                           
     CSR         A5DEL2    ANDEQ*BLANK                                          
     CSR                   MOVE '1'       @MK,03                                
     CSR                   SETON                     6193                       
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Credit Hold Exempt                                  
     C*                                                                         
     CSR                   MOVELVDEXHD    A5EXHD                                
     C*                                                                         
     C*    Set default value - Credit Hold Exempt                               
     C*                                                                         
B1   CSR         A5EXHD    IFEQ *BLANK                                          
B2   CSR         D@EXHD    IFNE *BLANK                                          
     CSR                   MOVEAD@EXHD    @40                                   
     CSR                   MOVEA@40       A5EXHD                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5EXHD                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Credit Hold Exempt                             
     C*                                                                         
B1   CSR         A@EXHD    IFNE *BLANK                                          
     CSR                   MOVEAA@EXHD    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                    ---- ----                                            
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5EXHD    $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     7193                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Credit Hold Exempt                      
     C*                                                                         
B1   CSR         L@EXHD    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         A5EXHD    IFGE L@EXHD                                          
B3   CSR         A5EXHD    IFLE U@EXHD                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     7193                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Credit Hold Exempt                    
     C*                                                                         
B1   CSR         R@EXHD    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@EXHD    #USY                                  
     CSR                   MOVE R@EXHD    #URT                                  
     CSR                   MOVE A5EXHD    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     7193                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Print Message                                       
     C*                                                                         
     CSR                   MOVELVDINMG    A5INMG                                
     C*                                                                         
     C*    Set default value - Print Message                                    
     C*                                                                         
B1   CSR         A5INMG    IFEQ *BLANK                                          
B2   CSR         D@INMG    IFNE *BLANK                                          
     CSR                   MOVEAD@INMG    @40                                   
     CSR                   MOVEA@40       A5INMG                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5INMG                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Print Message                                  
     C*                                                                         
B1   CSR         A@INMG    IFNE *BLANK                                          
     CSR                   MOVEAA@INMG    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                    ---- ----                                            
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5INMG    $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     5593                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Print Message                           
     C*                                                                         
B1   CSR         L@INMG    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         A5INMG    IFGE L@INMG                                          
B3   CSR         A5INMG    IFLE U@INMG                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     5593                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Print Message                         
     C*                                                                         
B1   CSR         R@INMG    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@INMG    #USY                                  
     CSR                   MOVE R@INMG    #URT                                  
     CSR                   MOVE A5INMG    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     5593                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Minimum Order Value                                 
     C*                                                                         
     CSR                   MOVEAVDMINO    @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   MOVE F@MINO    #DSPD                                 
     CSR                   MOVE G@MINO    #DATD                                 
     CSR                   EXSR C00151                                          
     C*                    ---- ------                                          
     CSR                   MOVE #NUMBR    A5MINO                                
     C*                                                                         
     C*    Set default value - Minimum Order Value                              
     C*                                                                         
B1   CSR         VDMINO    IFEQ *BLANK                                          
     CSR         D@MINO    ANDNE*BLANK                                          
     CSR                   MOVEAD@MINO    @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   MOVE F@MINO    #DSPD                                 
     CSR                   MOVE G@MINO    #DATD                                 
     CSR                   EXSR C00151                                          
     C*                    ---- ------                                          
     CSR                   MOVE #NUMBR    A5MINO                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Minimum Order Value                     
     C*                                                                         
B1   CSR         L@MINO    IFNE *BLANK                                          
     CSR                   MOVE *BLANK    X@MINO 15                             
     CSR                   MOVE '1'       $ERTST                                
     CSR                   MOVELA5MINO    X@MINO                                
B2   CSR         X@MINO    IFGE L@MINO                                          
B3   CSR         X@MINO    IFLE U@MINO                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     7093                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Substitutes Allowed (Y/N)                           
     C*                                                                         
     CSR                   MOVELVDSBAL    A5SBAL                                
     C*                                                                         
     C*    Set default value - Substitutes Allowed (Y/N)                        
     C*                                                                         
B1   CSR         A5SBAL    IFEQ *BLANK                                          
B2   CSR         D@SBAL    IFNE *BLANK                                          
     CSR                   MOVEAD@SBAL    @40                                   
     CSR                   MOVEA@40       A5SBAL                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5SBAL                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Substitutes Allowed (Y/N)                      
     C*                                                                         
B1   CSR         A@SBAL    IFNE *BLANK                                          
     CSR                   MOVEAA@SBAL    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                                                                         
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5SBAL    $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     6893                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Substitutes Allowed (Y/N)               
     C*                                                                         
B1   CSR         L@SBAL    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         A5SBAL    IFGE L@SBAL                                          
B3   CSR         A5SBAL    IFLE U@SBAL                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     6893                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Substitutes Allowed (Y/N)             
     C*                                                                         
B1   CSR         R@SBAL    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@SBAL    #USY                                  
     CSR                   MOVE R@SBAL    #URT                                  
     CSR                   MOVE A5SBAL    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     6893                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Allow Partial Orders (Y/N)                          
     C*                                                                         
     CSR                   MOVELVDSI01    A5SI01                                
     C*                                                                         
     C*    Set default value - Allow Partial Orders (Y/N)                       
     C*                                                                         
B1   CSR         A5SI01    IFEQ *BLANK                                          
B2   CSR         D@SI01    IFNE *BLANK                                          
     CSR                   MOVEAD@SI01    @40                                   
     CSR                   MOVEA@40       A5SI01                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5SI01                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Partial Orders Allowed (Y/N)                   
     C*                                                                         
B1   CSR         A@SI01    IFNE *BLANK                                          
     CSR                   MOVEAA@SI01    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                                                                         
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5SI01    $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     5693                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Partial Orders Allowed (Y/N)            
     C*                                                                         
B1   CSR         L@SI01    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         A5SI01    IFGE L@SI01                                          
B3   CSR         A5SI01    IFLE U@SI01                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     5693                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Partial Orders Allowed (Y/N)          
     C*                                                                         
B1   CSR         R@SI01    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@SI01    #USY                                  
     CSR                   MOVE R@SI01    #URT                                  
     CSR                   MOVE A5SI01    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     5693                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
S2826C*----------------------------------------------------------------         
S2826C*                                                                         
S2826C*    Scrub and edit - COA Required (Y/N)                                  
S2826C*                                                                         
S7332CSR                   MOVELVDSI02    A5SI02                                
27512C                     MOVELVDSI03    A5SI03                                
S2826CSR                   MOVELVDSI04    A5SI04                                
S2826C*----------------------------------------------------------------         
S2826C*                                                                         
S2826C*    Scrub and edit - COC Required (Y/N)                                  
S2826C*                                                                         
S2826CSR                   MOVELVDSI05    A5SI05                                
     C*                                                                         
11044C           VDBLFR    IFEQ ' '                                             
11044C           VDBLFR    OREQ 'D'                                             
11044C           VDBLFR    OREQ 'W'                                             
11044C           VDBLFR    OREQ 'M'                                             
11044C           VDBLFR    OREQ 'H'                                             
11044C           VDBLFR    OREQ 'P'                                             
11044C                     ELSE                                                 
14329CSR                   MOVE '1'       @MK,15                                
11044C                     SETON                     4493                       
11044C                     ENDIF                                                
S4004CSR                   MOVELVDBLFR    A5BLFR                                
14329 *    If not blank, check to see if this is VMI account                    
14329CSR         VDBLFR    IFNE ' '                                             
14329CSR         VDBLFR    ANDNE'H'                                             
14329CSR         ABMCU     CHAINF0006                44                         
14329CSR         *IN44     IFEQ *ON                                             
14329CSR         *IN44     OREQ *OFF                                            
14329CSR         MCRP17    ANDNE'4  '                                           
14329CSR                   MOVE '1'       @MK,15                                
14329CSR                   SETON                     4493                       
14329CSR                   ENDIF                                                
14329CSR                   ENDIF                                                
14329C*----------------------------------------------------------------         
11044C           VDBLFR    IFNE 'P'                                             
11044C                     CLEARVDURDT                                          
11044C                     CLEARA5URDT                                          
11044C                     ENDIF                                                
14329 * Translate blanks to zeros                                               
14329CSR         ' ':'0'   XLATEVDURDT    VDURDT                                
14329 *    Validate entry for Day of Month                                      
14329CSR         VDBLFR    IFEQ 'P'                                             
14329C***11044   VDBLFR    OREQ 'S'                        Select               
14329CSR                   SELEC                                                
14329CSR         VDURDT    WHGT '00'                                            
14329CSR         VDURDT    ANDLE'28'                                            
25783C***11044   VDURDT    ANDLE'31'                                            
14329 *    Move to output - Day of Month for Billing                            
S6195CSR                   MOVE VDURDT    A5URDT                                
14329CSR                   OTHER                                                
14329 *    Invalid day-of-month entered                                         
14329CSR                   MOVE '1'       @MK,14                                
14329CSR                   SETON                     4393                       
14329CSR                   ENDSL                                                
14329CSR                   ENDIF                                                
     C*                                                                         
S6195CSR                   MOVELVDURCD    A5URCD                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Discount - Trade                                    
     C*                                                                         
     CSR                   MOVEAVDTRDC    @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   MOVE F@TRDC    #DSPD                                 
     CSR                   MOVE G@TRDC    #DATD                                 
     CSR                   EXSR C00151                                          
     C*                    ---- ------                                          
     CSR                   MOVE #NUMBR    A5TRDC                                
     C*                                                                         
     C*    Set default value - Discount - Trade                                 
     C*                                                                         
B1   CSR         VDTRDC    IFEQ *BLANK                                          
     CSR         D@TRDC    ANDNE*BLANK                                          
     CSR                   MOVEAD@TRDC    @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   MOVE F@TRDC    #DSPD                                 
     CSR                   MOVE G@TRDC    #DATD                                 
     CSR                   EXSR C00151                                          
     C*                    ---- ------                                          
     CSR                   MOVE #NUMBR    A5TRDC                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Discount - Trade                        
     C*                                                                         
B1   CSR         L@TRDC    IFNE *BLANK                                          
     CSR                   MOVE *BLANK    X@TRDC 15                             
     CSR                   MOVE '1'       $ERTST                                
     CSR                   MOVELA5TRDC    X@TRDC                                
B2   CSR         X@TRDC    IFGE L@TRDC                                          
B3   CSR         X@TRDC    IFLE U@TRDC                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                       93                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Maximum Order Value                                 
     C*                                                                         
     CSR                   MOVEAVDMAXO    @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   MOVE F@MAXO    #DSPD                                 
     CSR                   MOVE G@MAXO    #DATD                                 
     CSR                   EXSR C00151                                          
     C*                    ---- ------                                          
     CSR                   MOVE #NUMBR    A5MAXO                                
     C*                                                                         
     C*    Set default value - Maximum Order Value                              
     C*                                                                         
B1   CSR         VDMAXO    IFEQ *BLANK                                          
     CSR         D@MAXO    ANDNE*BLANK                                          
     CSR                   MOVEAD@MAXO    @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   MOVE F@MAXO    #DSPD                                 
     CSR                   MOVE G@MAXO    #DATD                                 
     CSR                   EXSR C00151                                          
     C*                    ---- ------                                          
     CSR                   MOVE #NUMBR    A5MAXO                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Maximum Order Value                     
     C*                                                                         
B1   CSR         L@MAXO    IFNE *BLANK                                          
     CSR                   MOVE *BLANK    X@MAXO 15                             
     CSR                   MOVE '1'       $ERTST                                
     CSR                   MOVELA5MAXO    X@MAXO                                
B2   CSR         X@MAXO    IFGE L@MAXO                                          
B3   CSR         X@MAXO    IFLE U@MAXO                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     5493                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Batch Processing Mode                               
     C*                                                                         
     CSR                   MOVELVDEDPM    A5EDPM                                
     C*                                                                         
     C*    Set default value - Batch Processing Mode                            
     C*                                                                         
B1   CSR         A5EDPM    IFEQ *BLANK                                          
B2   CSR         D@EDPM    IFNE *BLANK                                          
     CSR                   MOVEAD@EDPM    @40                                   
     CSR                   MOVEA@40       A5EDPM                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5EDPM                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Batch Processing Mode                          
     C*                                                                         
B1   CSR         A@EDPM    IFNE *BLANK                                          
     CSR                   MOVEAA@EDPM    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                    ---- ----                                            
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5EDPM    $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     4493                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Batch Processing Mode                   
     C*                                                                         
B1   CSR         L@EDPM    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         A5EDPM    IFGE L@EDPM                                          
B3   CSR         A5EDPM    IFLE U@EDPM                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     4493                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Batch Processing Mode                 
     C*                                                                         
B1   CSR         R@EDPM    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@EDPM    #USY                                  
     CSR                   MOVE R@EDPM    #URT                                  
     CSR                   MOVE A5EDPM    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     4493                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Customer Type Identifier                            
     C*                                                                         
     CSR                   MOVELVDEDCI    A5EDCI                                
     C*                                                                         
     C*    Set default value - Customer Type Identifier                         
     C*                                                                         
B1   CSR         A5EDCI    IFEQ *BLANK                                          
B2   CSR         D@EDCI    IFNE *BLANK                                          
     CSR                   MOVEAD@EDCI    @40                                   
     CSR                   MOVEA@40       A5EDCI                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5EDCI                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Customer Type Identifier                       
     C*                                                                         
B1   CSR         A@EDCI    IFNE *BLANK                                          
     CSR                   MOVEAA@EDCI    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                    ---- ----                                            
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5EDCI    $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     4593                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Customer Type Identifier                
     C*                                                                         
B1   CSR         L@EDCI    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         A5EDCI    IFGE L@EDCI                                          
B3   CSR         A5EDCI    IFLE U@EDCI                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     4593                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Customer Type Identifier              
     C*                                                                         
B1   CSR         R@EDCI    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@EDCI    #USY                                  
     CSR                   MOVE R@EDCI    #URT                                  
     CSR                   MOVE A5EDCI    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     4593                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Item Type Identifier                                
     C*                                                                         
     CSR                   MOVELVDEDII    A5EDII                                
     C*                                                                         
     C*    Set default value - Item Type Identifier                             
     C*                                                                         
B1   CSR         A5EDII    IFEQ *BLANK                                          
B2   CSR         D@EDII    IFNE *BLANK                                          
     CSR                   MOVEAD@EDII    @40                                   
     CSR                   MOVEA@40       A5EDII                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5EDII                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit allowed values - Item Type Identifier                           
     C*                                                                         
B1   CSR         A@EDII    IFNE *BLANK                                          
     CSR                   MOVEAA@EDII    @40                                   
     CSR                   MOVE *HIVAL    @AV                                   
     CSR                   EXSR C997                                            
     C*                    ---- ----                                            
     CSR                   MOVE ' '       $ERTST  1                             
     CSR                   MOVE *BLANK    $WRK10 10                             
     CSR                   MOVELA5EDII    $WRK10                                
B2   CSR         @AV,1     IFNE *HIVAL                                          
     CSR         $WRK10    LOKUP@AV                      81                     
B3   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE '1'       $ERTST                                
E3   CSR                   ENDIF                                                
B3   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     4893                       
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Item Type Identifier                    
     C*                                                                         
B1   CSR         L@EDII    IFNE *BLANK                                          
     CSR                   MOVE '1'       $ERTST                                
B2   CSR         A5EDII    IFGE L@EDII                                          
B3   CSR         A5EDII    IFLE U@EDII                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     4893                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit from descriptive titles - Item Type Identifier                  
     C*                                                                         
B1   CSR         R@EDII    IFNE *BLANK                                          
     CSR                   CLEARI0005U                                          
     CSR                   MOVE ' '       $ERTST                                
     CSR                   MOVELS@EDII    #USY                                  
     CSR                   MOVE R@EDII    #URT                                  
     CSR                   MOVE A5EDII    #UKY                                  
     CSR                   CALL 'X0005 '               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I0005U                                
     CSR                   MOVE #UERR     *IN81                                 
B2   CSR         *IN81     IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,09                                
     CSR                   SETON                     4893                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Quantity Decimals                                   
     C*                                                                         
     CSR                   MOVEAVDEDQD    @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   MOVE F@EDQD    #DSPD                                 
     CSR                   MOVE G@EDQD    #DATD                                 
     CSR                   EXSR C00151                                          
     C*                    ---- ------                                          
     CSR                   MOVE #NUMBR    A5EDQD                                
     C*                                                                         
     C*    Set default value - Quantity Decimals                                
     C*                                                                         
B1   CSR         VDEDQD    IFEQ *BLANK                                          
     CSR         D@EDQD    ANDNE*BLANK                                          
     CSR                   MOVEAD@EDQD    @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   MOVE F@EDQD    #DSPD                                 
     CSR                   MOVE G@EDQD    #DATD                                 
     CSR                   EXSR C00151                                          
     C*                    ---- ------                                          
     CSR                   MOVE #NUMBR    A5EDQD                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Quantity Deciamls                       
     C*                                                                         
B1   CSR         L@EDQD    IFNE *BLANK                                          
     CSR                   MOVE *BLANK    X@EDQD 15                             
     CSR                   MOVE '1'       $ERTST                                
     CSR                   MOVELA5EDQD    X@EDQD                                
B2   CSR         X@EDQD    IFGE L@EDQD                                          
B3   CSR         X@EDQD    IFLE U@EDQD                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     4993                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Scrub and edit - Amount Decimals                                     
     C*                                                                         
     CSR                   MOVEAVDEDAD    @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   MOVE F@EDAD    #DSPD                                 
     CSR                   MOVE G@EDAD    #DATD                                 
     CSR                   EXSR C00151                                          
     C*                    ---- ------                                          
     CSR                   MOVE #NUMBR    A5EDAD                                
     C*                                                                         
     C*    Set default value - Amount Decimals                                  
     C*                                                                         
B1   CSR         VDEDAD    IFEQ *BLANK                                          
     CSR         D@EDAD    ANDNE*BLANK                                          
     CSR                   MOVEAD@EDAD    @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   MOVE F@EDAD    #DSPD                                 
     CSR                   MOVE G@EDAD    #DATD                                 
     CSR                   EXSR C00151                                          
     C*                    ---- ------                                          
     CSR                   MOVE #NUMBR    A5EDAD                                
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Edit upper and lower range - Amount Deciamls                         
     C*                                                                         
B1   CSR         L@EDAD    IFNE *BLANK                                          
     CSR                   MOVE *BLANK    X@EDAD 15                             
     CSR                   MOVE '1'       $ERTST                                
     CSR                   MOVELA5EDAD    X@EDAD                                
B2   CSR         X@EDAD    IFGE L@EDAD                                          
B3   CSR         X@EDAD    IFLE U@EDAD                                          
     CSR                   MOVE ' '       $ERTST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
B2   CSR         $ERTST    IFEQ '1'                                             
     CSR                   MOVE '1'       @MK,07                                
     CSR                   SETON                     4393                       
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
B1   CSR         *IN22     IFEQ '1'                                             
     CSR         *IN93     ANDEQ'1'                                             
     CSR                   MOVE 'I'       @@PACT  1                             
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     CSR         END005    ENDSR                                                
     C*****************************************************************         
     C*                                                                         
     C*    Copy Common Subroutine - Currency - Translate Video Fields to Data Ba
     C*                                                                         
     C/COPY JDECPY,C00151                                                       
     C*****************************************************************         
     C*                                                                         
     C*    SUBROUTINE S005A - Load defaults for remaining fields.               
     C*    -------------------------------------------------------              
     C*                                                                         
     C*    Processing:  1.  Retrieve default values.                            
     C*                                                                         
     CSR         S005A     BEGSR                                                
     C*          -----     -----                                                
     C*                                                                         
     C*    If not addition or change, bypass subroutine                         
     C*                                                                         
B1   CSR         *IN21     IFEQ '0'                                             
     CSR         *IN22     ANDEQ'0'                                             
     CSR                   GOTO END05A                                          
     C*                    ---- ------                                          
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Set default value - Apply Freight - Y/N                              
     C*                                                                         
B1   CSR         A5AFT     IFEQ *BLANK                                          
B2   CSR         D@AFT     IFNE *BLANK                                          
     CSR                   MOVEAD@AFT     @40                                   
     CSR                   MOVEA@40       A5AFT                                 
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5AFT                                 
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Set default value - Rate - Commission 1                              
     C*                                                                         
B1   CSR         A5CMR1    IFEQ *ZEROS                                          
     CSR         D@CMR1    ANDNE*BLANK                                          
     CSR                   MOVEAD@CMR1    @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   MOVE F@CMR1    #DSPD                                 
     CSR                   MOVE G@CMR1    #DATD                                 
     CSR                   EXSR C00151                                          
     C*                    ---- ------                                          
     CSR                   MOVE #NUMBR    A5CMR1                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Set default value - Rate - Commission 2                              
     C*                                                                         
B1   CSR         A5CMR2    IFEQ *ZEROS                                          
     CSR         D@CMR2    ANDNE*BLANK                                          
     CSR                   MOVEAD@CMR2    @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   MOVE F@CMR2    #DSPD                                 
     CSR                   MOVE G@CMR2    #DATD                                 
     CSR                   EXSR C00151                                          
     C*                    ---- ------                                          
     CSR                   MOVE #NUMBR    A5CMR2                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Set default value - Freight Handling Code                            
     C*                                                                         
B1   CSR         A5FRTH    IFEQ *BLANK                                          
B2   CSR         D@FRTH    IFNE *BLANK                                          
     CSR                   MOVEAD@FRTH    @40                                   
     CSR                   MOVEA@40       A5FRTH                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5FRTH                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Set default value - Hold Orders Code                                 
     C*                                                                         
B1   CSR         A5HOLD    IFEQ *BLANK                                          
B2   CSR         D@HOLD    IFNE *BLANK                                          
     CSR                   MOVEAD@HOLD    @40                                   
     CSR                   MOVEA@40       A5HOLD                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5HOLD                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Set default value - Invoice Copies                                   
     C*                                                                         
B1   CSR         A5INVC    IFEQ *ZEROS                                          
     CSR         D@INVC    ANDNE*BLANK                                          
     CSR                   MOVEAD@INVC    @NM                                   
     CSR                   EXSR C0012                                           
     C*                    ---- -----                                           
     CSR                   MOVE F@INVC    #DSPD                                 
     CSR                   MOVE G@INVC    #DATD                                 
     CSR                   EXSR C00151                                          
     C*                    ---- ------                                          
     CSR                   MOVE #NUMBR    A5INVC                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Set default value - Price Pick List (Y/N)                            
     C*                                                                         
B1   CSR         A5PLST    IFEQ *BLANK                                          
B2   CSR         D@PLST    IFNE *BLANK                                          
     CSR                   MOVEAD@PLST    @40                                   
     CSR                   MOVEA@40       A5PLST                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5PLST                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Set default value - Priority - Processing                            
     C*                                                                         
B1   CSR         A5PRIO    IFEQ *BLANK                                          
B2   CSR         D@PRIO    IFNE *BLANK                                          
     CSR                   MOVEAD@PRIO    @40                                   
     CSR                   MOVEA@40       A5PRIO                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5PRIO                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Set default value - Route Code                                       
     C*                                                                         
B1   CSR         A5ROUT    IFEQ *BLANK                                          
B2   CSR         D@ROUT    IFNE *BLANK                                          
     CSR                   MOVEAD@ROUT    @40                                   
     CSR                   MOVEA@40       A5ROUT                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5ROUT                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Set default value - Stop Code                                        
     C*                                                                         
B1   CSR         A5STOP    IFEQ *BLANK                                          
B2   CSR         D@STOP    IFNE *BLANK                                          
     CSR                   MOVEAD@STOP    @40                                   
     CSR                   MOVEA@40       A5STOP                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5STOP                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Set default value - Unit of Measure - Volume Display                 
     C*                                                                         
B1   CSR         A5VUMD    IFEQ *BLANK                                          
B2   CSR         D@VUMD    IFNE *BLANK                                          
     CSR                   MOVEAD@VUMD    @40                                   
     CSR                   MOVEA@40       A5VUMD                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5VUMD                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Set default value - Unit of Measure - Weight Display                 
     C*                                                                         
B1   CSR         A5WUMD    IFEQ *BLANK                                          
B2   CSR         D@WUMD    IFNE *BLANK                                          
     CSR                   MOVEAD@WUMD    @40                                   
     CSR                   MOVEA@40       A5WUMD                                
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5WUMD                                
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Set default value - Zone Number                                      
     C*                                                                         
B1   CSR         A5ZON     IFEQ *BLANK                                          
B2   CSR         D@ZON     IFNE *BLANK                                          
     CSR                   MOVEAD@ZON     @40                                   
     CSR                   MOVEA@40       A5ZON                                 
B3   CSR         @40,1     IFEQ ''''                                            
     CSR                   MOVE ' '       @40,1                                 
     CSR                   Z-ADD2         #M                                    
B4   CSR         #M        DOWLE40                                              
B5   CSR         @40,#M    IFEQ ''''                                            
     CSR                   MOVE ' '       @40,#M                                
E5   CSR                   ENDIF                                                
     CSR                   ADD  1         #M                                    
E4   CSR                   ENDDO                                                
     CSR                   MOVEA@40,2     A5ZON                                 
E3   CSR                   ENDIF                                                
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     CSR         END05A    ENDSR                                                
     C*****************************************************************         
     C*                                                                         
     C*    SUBROUTINE S010  - Update Data Base                                  
     C*    -----------------------------------                                  
     C*                                                                         
     C*    Processing:  1.  Update data base file based upon valid              
     C*                     action codes.                                       
     C*                                                                         
     CSR         S010      BEGSR                                                
     C*          ----      -----                                                
     C*                                                                         
     C*----------------------------------------------------------------         
     CSR                   TIME           $TDAY                                 
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    If change action, update record.                                     
     C*                                                                         
B1   CSR         *IN22     IFEQ '1'                                             
     CSR                   MOVE ##USER    A5USER                                
     CSR                   MOVE ##JOBN    A5JOBN                                
     CSR                   MOVE ##PROG    A5PID                                 
     CSR                   MOVE $$UPMJ    A5UPMJ                                
     CSR                   MOVE $TDAY     A5UPMT                                
     C*                                                                         
     CSR                   MOVEL'A71     '@@FMT                                 
     CSR                   MOVE 'K'       @@ACCS                                
     CSR                   MOVEL'UPDAT   '@@OPER                                
     CSR                   MOVE 'N'       @@LOCK                                
     CSR                   MOVE 'N'       @@CHGR                                
     CSR                   MOVEL'A5KY00  '@@KLST                                
     CSR                   Z-ADD1         @@KNUM                                
     CSR                   CALL 'XF0301'               99                       
     C*                    ---- --------                                        
     CSR                   PARM           PS@@1                                 
     CSR                   PARM           I0301                                 
E1   CSR                   ENDIF                                                
     C*                                                                         
     C*    Call SMS to Update                                                   
     C*                                                                         
     CSR         $@ASMS    IFEQ '1'                                             
     CSR         *IN21     IFEQ '1'                                             
     CSR         *IN22     OREQ '1'                                             
     CSR         *IN23     OREQ '1'                                             
     CSR                   MOVE A5AN8     ZZAN8   8                             
     CSR                   MOVE 'M'       ZZMODE  1                             
     CSR                   CALL 'SMR9010'                                       
     C*                    ----  -------                                        
     CSR                   PARM           ZZAN8                                 
     CSR                   PARM           ZZMODE                                
     CSR                   END                                                  
     CSR                   END                                                  
     C*                                                                         
     C*    Clear data field for next transaction                                
     C*                                                                         
     CSR                   MOVE #FCLR     @@AID                                 
     CSR                   EXSR S001                                            
     C*                    ---- ----                                            
     C*----------------------------------------------------------------         
     CSR         END010    ENDSR                                                
     C****************************************************************          
     C*                                                                         
     C*    Copy Common Subroutine - Build allowed values work arrays   o Data Ba
     C*                                                                         
     C/COPY JDECPY,C997                                                         
     C*****************************************************************         
     C*                                                                         
     C*    SUBROUTINE S998  - Load dictionary parameters.                       
     C*    ----------------------------------------------                       
     C*                                                                         
     CSR         S998      BEGSR                                                
     C*          ----      -----                                                
     C*                                                                         
     C*    Dictionary parameters for - Apply Freight - Y/N                      
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'AFT'     FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B1   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@AFT  40                             
     CSR                   MOVE FRDTAT    T@AFT   1                             
     CSR                   MOVE FREC      E@AFT   1                             
     CSR                   MOVE FRDTAS    C@AFT   40                            
     CSR                   MOVE FRDTAD    G@AFT   10                            
     CSR                   MOVE FRCDEC    F@AFT   1                             
     CSR                   MOVELFRSY      S@AFT   4                             
     CSR                   MOVE FRRT      R@AFT   2                             
     CSR                   MOVE FRDVAL    D@AFT  40                             
     CSR                   MOVE FRVAL     A@AFT  40                             
     CSR                   MOVE FRLVAL    L@AFT  40                             
     CSR                   MOVE FRUVAL    U@AFT  40                             
     CSR                   MOVE FREDWR    W@AFT  30                             
     CSR                   MOVE FRLR      J@AFT   1                             
     CSR                   MOVE FRNNIX    N@AFT   20                            
     CSR                   Z-ADD1         #@AFT  110                            
     CSR                   MOVE F@AFT     #A                                    
B2   CSR                   DO   #A                                              
     CSR                   MULT 10        #@AFT                                 
E2   CSR                   ENDDO                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Address Number                           
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'AN8'     FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B1   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@AN8  40                             
     CSR                   MOVE FRDTAT    T@AN8   1                             
     CSR                   MOVE FREC      E@AN8   1                             
     CSR                   MOVE FRDTAS    C@AN8   40                            
     CSR                   MOVE FRDTAD    G@AN8   10                            
     CSR                   MOVE FRCDEC    F@AN8   1                             
     CSR                   MOVELFRSY      S@AN8   4                             
     CSR                   MOVE FRRT      R@AN8   2                             
     CSR                   MOVE FRDVAL    D@AN8  40                             
     CSR                   MOVE FRVAL     A@AN8  40                             
     CSR                   MOVE FRLVAL    L@AN8  40                             
     CSR                   MOVE FRUVAL    U@AN8  40                             
     CSR                   MOVE FREDWR    W@AN8  30                             
     CSR                   MOVE FRLR      J@AN8   1                             
     CSR                   MOVE FRNNIX    N@AN8   20                            
     CSR                   Z-ADD1         #@AN8  110                            
     CSR                   MOVE F@AN8     #A                                    
B2   CSR                   DO   #A                                              
     CSR                   MULT 10        #@AN8                                 
E2   CSR                   ENDDO                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Order Template                           
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'ORTP'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B1   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVELFRSY      S@ORTP  4                             
     CSR                   MOVE FRRT      R@ORTP  2                             
     CSR                   MOVE FRCDEC    F@ORTP  1                             
     CSR                   Z-ADD1         #@ORTP 110                            
     CSR                   MOVE F@ORTP    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@ORTP                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Delivery Instructions Line 1             
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'DEL1'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@DEL1 40                             
     CSR                   MOVE FRDTAT    T@DEL1  1                             
     CSR                   MOVE FREC      E@DEL1  1                             
     CSR                   MOVE FRDTAS    C@DEL1  40                            
     CSR                   MOVE FRDTAD    G@DEL1  10                            
     CSR                   MOVE FRCDEC    F@DEL1  1                             
     CSR                   MOVELFRSY      S@DEL1  4                             
     CSR                   MOVE FRRT      R@DEL1  2                             
     CSR                   MOVE FRDVAL    D@DEL1 40                             
     CSR                   MOVE FRVAL     A@DEL1 40                             
     CSR                   MOVE FRLVAL    L@DEL1 40                             
     CSR                   MOVE FRUVAL    U@DEL1 40                             
     CSR                   MOVE FREDWR    W@DEL1 30                             
     CSR                   MOVE FRLR      J@DEL1  1                             
     CSR                   MOVE FRNNIX    N@DEL1  20                            
     CSR                   Z-ADD1         #@DEL1 110                            
     CSR                   MOVE F@DEL1    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@DEL1                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Delivery Instructions Line 2             
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'DEL2'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@DEL2 40                             
     CSR                   MOVE FRDTAT    T@DEL2  1                             
     CSR                   MOVE FREC      E@DEL2  1                             
     CSR                   MOVE FRDTAS    C@DEL2  40                            
     CSR                   MOVE FRDTAD    G@DEL2  10                            
     CSR                   MOVE FRCDEC    F@DEL2  1                             
     CSR                   MOVELFRSY      S@DEL2  4                             
     CSR                   MOVE FRRT      R@DEL2  2                             
     CSR                   MOVE FRDVAL    D@DEL2 40                             
     CSR                   MOVE FRVAL     A@DEL2 40                             
     CSR                   MOVE FRLVAL    L@DEL2 40                             
     CSR                   MOVE FRUVAL    U@DEL2 40                             
     CSR                   MOVE FREDWR    W@DEL2 30                             
     CSR                   MOVE FRLR      J@DEL2  1                             
     CSR                   MOVE FRNNIX    N@DEL2  20                            
     CSR                   Z-ADD1         #@DEL2 110                            
     CSR                   MOVE F@DEL2    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@DEL2                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Partial Shipments Allowed (Y/N)          
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'APTS'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@APTS 40                             
     CSR                   MOVE FRDTAT    T@APTS  1                             
     CSR                   MOVE FREC      E@APTS  1                             
     CSR                   MOVE FRDTAS    C@APTS  40                            
     CSR                   MOVE FRDTAD    G@APTS  10                            
     CSR                   MOVE FRCDEC    F@APTS  1                             
     CSR                   MOVELFRSY      S@APTS  4                             
     CSR                   MOVE FRRT      R@APTS  2                             
     CSR                   MOVE FRDVAL    D@APTS 40                             
     CSR                   MOVE FRVAL     A@APTS 40                             
     CSR                   MOVE FRLVAL    L@APTS 40                             
     CSR                   MOVE FRUVAL    U@APTS 40                             
     CSR                   MOVE FREDWR    W@APTS 30                             
     CSR                   MOVE FRLR      J@APTS  1                             
     CSR                   MOVE FRNNIX    N@APTS  20                            
     CSR                   Z-ADD1         #@APTS 110                            
     CSR                   MOVE F@APTS    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@APTS                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Related - Address Number                 
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'AN8R'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
     CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@AN8R 40                             
     CSR                   MOVE FRDTAT    T@AN8R  1                             
     CSR                   MOVE FREC      E@AN8R  1                             
     CSR                   MOVE FRDTAS    C@AN8R  40                            
     CSR                   MOVE FRDTAD    G@AN8R  10                            
     CSR                   MOVE FRCDEC    F@AN8R  1                             
     CSR                   MOVELFRSY      S@AN8R  4                             
     CSR                   MOVE FRRT      R@AN8R  2                             
     CSR                   MOVE FRDVAL    D@AN8R 40                             
     CSR                   MOVE FRVAL     A@AN8R 40                             
     CSR                   MOVE FRLVAL    L@AN8R 40                             
     CSR                   MOVE FRUVAL    U@AN8R 40                             
     CSR                   MOVE FREDWR    W@AN8R 30                             
     CSR                   MOVE FRLR      J@AN8R  1                             
     CSR                   MOVE FRNNIX    N@AN8R  20                            
     CSR                   Z-ADD1         #@AN8R 110                            
     CSR                   MOVE F@AN8R    #A                                    
     CSR                   DO   #A                                              
     CSR                   MULT 10        #@AN8R                                
     CSR                   END                                                  
     CSR                   END                                                  
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Accounts Receivable (C/P/S)              
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'ARTO'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@ARTO 40                             
     CSR                   MOVE FRDTAT    T@ARTO  1                             
     CSR                   MOVE FREC      E@ARTO  1                             
     CSR                   MOVE FRDTAS    C@ARTO  40                            
     CSR                   MOVE FRDTAD    G@ARTO  10                            
     CSR                   MOVE FRCDEC    F@ARTO  1                             
     CSR                   MOVELFRSY      S@ARTO  4                             
     CSR                   MOVE FRRT      R@ARTO  2                             
     CSR                   MOVE FRDVAL    D@ARTO 40                             
     CSR                   MOVE FRVAL     A@ARTO 40                             
     CSR                   MOVE FRLVAL    L@ARTO 40                             
     CSR                   MOVE FRUVAL    U@ARTO 40                             
     CSR                   MOVE FREDWR    W@ARTO 30                             
     CSR                   MOVE FRLR      J@ARTO  1                             
     CSR                   MOVE FRNNIX    N@ARTO  20                            
     CSR                   Z-ADD1         #@ARTO 110                            
     CSR                   MOVE F@ARTO    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@ARTO                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Customer PO Required (Y/N/ )             
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'PORQ'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
     CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@PORQ 40                             
     CSR                   MOVE FRDTAT    T@PORQ  1                             
     CSR                   MOVE FREC      E@PORQ  1                             
     CSR                   MOVE FRDTAS    C@PORQ  40                            
     CSR                   MOVE FRDTAD    G@PORQ  10                            
     CSR                   MOVE FRCDEC    F@PORQ  1                             
     CSR                   MOVELFRSY      S@PORQ  4                             
     CSR                   MOVE FRRT      R@PORQ  2                             
     CSR                   MOVE FRDVAL    D@PORQ 40                             
     CSR                   MOVE FRVAL     A@PORQ 40                             
     CSR                   MOVE FRLVAL    L@PORQ 40                             
     CSR                   MOVE FRUVAL    U@PORQ 40                             
     CSR                   MOVE FREDWR    W@PORQ 30                             
     CSR                   MOVE FRLR      J@PORQ  1                             
     CSR                   MOVE FRNNIX    N@PORQ  20                            
     CSR                   Z-ADD1         #@PORQ 110                            
     CSR                   MOVE F@PORQ    #A                                    
     CSR                   DO   #A                                              
     CSR                   MULT 10        #@PORQ                                
     CSR                   END                                                  
     CSR                   END                                                  
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Delivery Notes (Y/N)                     
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'EDF1'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@EDF1 40                             
     CSR                   MOVE FRDTAT    T@EDF1  1                             
     CSR                   MOVE FREC      E@EDF1  1                             
     CSR                   MOVE FRDTAS    C@EDF1  40                            
     CSR                   MOVE FRDTAD    G@EDF1  10                            
     CSR                   MOVE FRCDEC    F@EDF1  1                             
     CSR                   MOVELFRSY      S@EDF1  4                             
     CSR                   MOVE FRRT      R@EDF1  2                             
     CSR                   MOVE FRDVAL    D@EDF1 40                             
     CSR                   MOVE FRVAL     A@EDF1 40                             
     CSR                   MOVE FRLVAL    L@EDF1 40                             
     CSR                   MOVE FRUVAL    U@EDF1 40                             
     CSR                   MOVE FREDWR    W@EDF1 30                             
     CSR                   MOVE FRLR      J@EDF1  1                             
     CSR                   MOVE FRNNIX    N@EDF1  20                            
     CSR                   Z-ADD1         #@EDF1 110                            
     CSR                   MOVE F@EDF1    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@EDF1                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Item Restrictions                        
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'EDF2'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@EDF2 40                             
     CSR                   MOVE FRDTAT    T@EDF2  1                             
     CSR                   MOVE FREC      E@EDF2  1                             
     CSR                   MOVE FRDTAS    C@EDF2  40                            
     CSR                   MOVE FRDTAD    G@EDF2  10                            
     CSR                   MOVE FRCDEC    F@EDF2  1                             
     CSR                   MOVELFRSY      S@EDF2  4                             
     CSR                   MOVE FRRT      R@EDF2  2                             
     CSR                   MOVE FRDVAL    D@EDF2 40                             
     CSR                   MOVE FRVAL     A@EDF2 40                             
     CSR                   MOVE FRLVAL    L@EDF2 40                             
     CSR                   MOVE FRUVAL    U@EDF2 40                             
     CSR                   MOVE FREDWR    W@EDF2 30                             
     CSR                   MOVE FRLR      J@EDF2  1                             
     CSR                   MOVE FRNNIX    N@EDF2  20                            
     CSR                   Z-ADD1         #@EDF2 110                            
     CSR                   MOVE F@EDF2    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@EDF2                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Invoice Consolidation (Y/N)              
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'ICON'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@ICON 40                             
     CSR                   MOVE FRDTAT    T@ICON  1                             
     CSR                   MOVE FREC      E@ICON  1                             
     CSR                   MOVE FRDTAS    C@ICON  40                            
     CSR                   MOVE FRDTAD    G@ICON  10                            
     CSR                   MOVE FRCDEC    F@ICON  1                             
     CSR                   MOVELFRSY      S@ICON  4                             
     CSR                   MOVE FRRT      R@ICON  2                             
     CSR                   MOVE FRDVAL    D@ICON 40                             
     CSR                   MOVE FRVAL     A@ICON 40                             
     CSR                   MOVE FRLVAL    L@ICON 40                             
     CSR                   MOVE FRUVAL    U@ICON 40                             
     CSR                   MOVE FREDWR    W@ICON 30                             
     CSR                   MOVE FRLR      J@ICON  1                             
     CSR                   MOVE FRNNIX    N@ICON  20                            
     CSR                   Z-ADD1         #@ICON 110                            
     CSR                   MOVE F@ICON    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@ICON                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Backorders Allowed (Y/N)                 
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'BACK'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@BACK 40                             
     CSR                   MOVE FRDTAT    T@BACK  1                             
     CSR                   MOVE FREC      E@BACK  1                             
     CSR                   MOVE FRDTAS    C@BACK  40                            
     CSR                   MOVE FRDTAD    G@BACK  10                            
     CSR                   MOVE FRCDEC    F@BACK  1                             
     CSR                   MOVELFRSY      S@BACK  4                             
     CSR                   MOVE FRRT      R@BACK  2                             
     CSR                   MOVE FRDVAL    D@BACK 40                             
     CSR                   MOVE FRVAL     A@BACK 40                             
     CSR                   MOVE FRLVAL    L@BACK 40                             
     CSR                   MOVE FRUVAL    U@BACK 40                             
     CSR                   MOVE FREDWR    W@BACK 30                             
     CSR                   MOVE FRLR      J@BACK  1                             
     CSR                   MOVE FRNNIX    N@BACK  20                            
     CSR                   Z-ADD1         #@BACK 110                            
     CSR                   MOVE F@BACK    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@BACK                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Billing Address Type                     
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'BADT'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@BADT 40                             
     CSR                   MOVE FRDTAT    T@BADT  1                             
     CSR                   MOVE FREC      E@BADT  1                             
     CSR                   MOVE FRDTAS    C@BADT  40                            
     CSR                   MOVE FRDTAD    G@BADT  10                            
     CSR                   MOVE FRCDEC    F@BADT  1                             
     CSR                   MOVELFRSY      S@BADT  4                             
     CSR                   MOVE FRRT      R@BADT  2                             
     CSR                   MOVE FRDVAL    D@BADT 40                             
     CSR                   MOVE FRVAL     A@BADT 40                             
     CSR                   MOVE FRLVAL    L@BADT 40                             
     CSR                   MOVE FRUVAL    U@BADT 40                             
     CSR                   MOVE FREDWR    W@BADT 30                             
     CSR                   MOVE FRLR      J@BADT  1                             
     CSR                   MOVE FRNNIX    N@BADT  20                            
     CSR                   Z-ADD1         #@BADT 110                            
     CSR                   MOVE F@BADT    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@BADT                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Rate - Commission 1                      
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'CMR1'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@CMR1 40                             
     CSR                   MOVE FRDTAT    T@CMR1  1                             
     CSR                   MOVE FREC      E@CMR1  1                             
     CSR                   MOVE FRDTAS    C@CMR1  40                            
     CSR                   MOVE FRDTAD    G@CMR1  10                            
     CSR                   MOVE FRCDEC    F@CMR1  1                             
     CSR                   MOVELFRSY      S@CMR1  4                             
     CSR                   MOVE FRRT      R@CMR1  2                             
     CSR                   MOVE FRDVAL    D@CMR1 40                             
     CSR                   MOVE FRVAL     A@CMR1 40                             
     CSR                   MOVE FRLVAL    L@CMR1 40                             
     CSR                   MOVE FRUVAL    U@CMR1 40                             
     CSR                   MOVE FREDWR    W@CMR1 30                             
     CSR                   MOVE FRLR      J@CMR1  1                             
     CSR                   MOVE FRNNIX    N@CMR1  20                            
     CSR                   Z-ADD1         #@CMR1 110                            
     CSR                   MOVE F@CMR1    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@CMR1                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Rate - Commission 2                      
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'CMR2'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@CMR2 40                             
     CSR                   MOVE FRDTAT    T@CMR2  1                             
     CSR                   MOVE FREC      E@CMR2  1                             
     CSR                   MOVE FRDTAS    C@CMR2  40                            
     CSR                   MOVE FRDTAD    G@CMR2  10                            
     CSR                   MOVE FRCDEC    F@CMR2  1                             
     CSR                   MOVELFRSY      S@CMR2  4                             
     CSR                   MOVE FRRT      R@CMR2  2                             
     CSR                   MOVE FRDVAL    D@CMR2 40                             
     CSR                   MOVE FRVAL     A@CMR2 40                             
     CSR                   MOVE FRLVAL    L@CMR2 40                             
     CSR                   MOVE FRUVAL    U@CMR2 40                             
     CSR                   MOVE FREDWR    W@CMR2 30                             
     CSR                   MOVE FRLR      J@CMR2  1                             
     CSR                   MOVE FRNNIX    N@CMR2  20                            
     CSR                   Z-ADD1         #@CMR2 110                            
     CSR                   MOVE F@CMR2    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@CMR2                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Customer Pricing Rule                    
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'CPGP'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@CPGP 40                             
     CSR                   MOVE FRDTAT    T@CPGP  1                             
     CSR                   MOVE FREC      E@CPGP  1                             
     CSR                   MOVE FRDTAS    C@CPGP  40                            
     CSR                   MOVE FRDTAD    G@CPGP  10                            
     CSR                   MOVE FRCDEC    F@CPGP  1                             
     CSR                   MOVELFRSY      S@CPGP  4                             
     CSR                   MOVE FRRT      R@CPGP  2                             
     CSR                   MOVE FRDVAL    D@CPGP 40                             
     CSR                   MOVE FRVAL     A@CPGP 40                             
     CSR                   MOVE FRLVAL    L@CPGP 40                             
     CSR                   MOVE FRUVAL    U@CPGP 40                             
     CSR                   MOVE FREDWR    W@CPGP 30                             
     CSR                   MOVE FRLR      J@CPGP  1                             
     CSR                   MOVE FRNNIX    N@CPGP  20                            
     CSR                   Z-ADD1         #@CPGP 110                            
     CSR                   MOVE F@CPGP    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@CPGP                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Price Adjustment Schedule Name           
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'ASN'     FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ----  ------                                         
     CSR                   PARM           I9800E                                
B1   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@ASN  40                             
     CSR                   MOVE FRDTAT    T@ASN   1                             
     CSR                   MOVE FREC      E@ASN   1                             
     CSR                   MOVE FRDTAS    C@ASN   50                            
     CSR                   MOVE FRDTAD    G@ASN   20                            
     CSR                   MOVE FRCDEC    F@ASN   1                             
     CSR                   MOVELFRSY      S@ASN   4                             
     CSR                   MOVE FRRT      R@ASN   2                             
     CSR                   MOVE FRDVAL    D@ASN  40                             
     CSR                   MOVE FRVAL     A@ASN  40                             
     CSR                   MOVE FRLVAL    L@ASN  40                             
     CSR                   MOVE FRUVAL    U@ASN  40                             
     CSR                   MOVE FREDWR    W@ASN  30                             
     CSR                   MOVE FRLR      J@ASN   1                             
     CSR                   MOVE FRNNIX    N@ASN   20                            
     CSR                   Z-ADD1         #@ASN  110                            
     CSR                   MOVE F@ASN     #A                                    
B2   CSR                   DO   #A                                              
     CSR                   MULT 10        #@ASN                                 
E2   CSR                   ENDDO                                                
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Credit Hold Exempt                       
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'EXHD'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@EXHD 40                             
     CSR                   MOVE FRDTAT    T@EXHD  1                             
     CSR                   MOVE FREC      E@EXHD  1                             
     CSR                   MOVE FRDTAS    C@EXHD  40                            
     CSR                   MOVE FRDTAD    G@EXHD  10                            
     CSR                   MOVE FRCDEC    F@EXHD  1                             
     CSR                   MOVELFRSY      S@EXHD  4                             
     CSR                   MOVE FRRT      R@EXHD  2                             
     CSR                   MOVE FRDVAL    D@EXHD 40                             
     CSR                   MOVE FRVAL     A@EXHD 40                             
     CSR                   MOVE FRLVAL    L@EXHD 40                             
     CSR                   MOVE FRUVAL    U@EXHD 40                             
     CSR                   MOVE FREDWR    W@EXHD 30                             
     CSR                   MOVE FRLR      J@EXHD  1                             
     CSR                   MOVE FRNNIX    N@EXHD  20                            
     CSR                   Z-ADD1         #@EXHD 110                            
     CSR                   MOVE F@EXHD    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@EXHD                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Freight Handling Code                    
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'FRTH'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@FRTH 40                             
     CSR                   MOVE FRDTAT    T@FRTH  1                             
     CSR                   MOVE FREC      E@FRTH  1                             
     CSR                   MOVE FRDTAS    C@FRTH  40                            
     CSR                   MOVE FRDTAD    G@FRTH  10                            
     CSR                   MOVE FRCDEC    F@FRTH  1                             
     CSR                   MOVELFRSY      S@FRTH  4                             
     CSR                   MOVE FRRT      R@FRTH  2                             
     CSR                   MOVE FRDVAL    D@FRTH 40                             
     CSR                   MOVE FRVAL     A@FRTH 40                             
     CSR                   MOVE FRLVAL    L@FRTH 40                             
     CSR                   MOVE FRUVAL    U@FRTH 40                             
     CSR                   MOVE FREDWR    W@FRTH 30                             
     CSR                   MOVE FRLR      J@FRTH  1                             
     CSR                   MOVE FRNNIX    N@FRTH  20                            
     CSR                   Z-ADD1         #@FRTH 110                            
     CSR                   MOVE F@FRTH    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@FRTH                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Hold Orders Code                         
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'HOLD'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@HOLD 40                             
     CSR                   MOVE FRDTAT    T@HOLD  1                             
     CSR                   MOVE FREC      E@HOLD  1                             
     CSR                   MOVE FRDTAS    C@HOLD  40                            
     CSR                   MOVE FRDTAD    G@HOLD  10                            
     CSR                   MOVE FRCDEC    F@HOLD  1                             
     CSR                   MOVELFRSY      S@HOLD  4                             
     CSR                   MOVE FRRT      R@HOLD  2                             
     CSR                   MOVE FRDVAL    D@HOLD 40                             
     CSR                   MOVE FRVAL     A@HOLD 40                             
     CSR                   MOVE FRLVAL    L@HOLD 40                             
     CSR                   MOVE FRUVAL    U@HOLD 40                             
     CSR                   MOVE FREDWR    W@HOLD 30                             
     CSR                   MOVE FRLR      J@HOLD  1                             
     CSR                   MOVE FRNNIX    N@HOLD  20                            
     CSR                   Z-ADD1         #@HOLD 110                            
     CSR                   MOVE F@HOLD    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@HOLD                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Print Message                            
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'INMG'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@INMG 40                             
     CSR                   MOVE FRDTAT    T@INMG  1                             
     CSR                   MOVE FREC      E@INMG  1                             
     CSR                   MOVE FRDTAS    C@INMG  40                            
     CSR                   MOVE FRDTAD    G@INMG  10                            
     CSR                   MOVE FRCDEC    F@INMG  1                             
     CSR                   MOVELFRSY      S@INMG  4                             
     CSR                   MOVE FRRT      R@INMG  2                             
     CSR                   MOVE FRDVAL    D@INMG 40                             
     CSR                   MOVE FRVAL     A@INMG 40                             
     CSR                   MOVE FRLVAL    L@INMG 40                             
     CSR                   MOVE FRUVAL    U@INMG 40                             
     CSR                   MOVE FREDWR    W@INMG 30                             
     CSR                   MOVE FRLR      J@INMG  1                             
     CSR                   MOVE FRNNIX    N@INMG  20                            
     CSR                   Z-ADD1         #@INMG 110                            
     CSR                   MOVE F@INMG    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@INMG                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Invoice Copies                           
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'INVC'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@INVC 40                             
     CSR                   MOVE FRDTAT    T@INVC  1                             
     CSR                   MOVE FREC      E@INVC  1                             
     CSR                   MOVE FRDTAS    C@INVC  40                            
     CSR                   MOVE FRDTAD    G@INVC  10                            
     CSR                   MOVE FRCDEC    F@INVC  1                             
     CSR                   MOVELFRSY      S@INVC  4                             
     CSR                   MOVE FRRT      R@INVC  2                             
     CSR                   MOVE FRDVAL    D@INVC 40                             
     CSR                   MOVE FRVAL     A@INVC 40                             
     CSR                   MOVE FRLVAL    L@INVC 40                             
     CSR                   MOVE FRUVAL    U@INVC 40                             
     CSR                   MOVE FREDWR    W@INVC 30                             
     CSR                   MOVE FRLR      J@INVC  1                             
     CSR                   MOVE FRNNIX    N@INVC  20                            
     CSR                   Z-ADD1         #@INVC 110                            
     CSR                   MOVE F@INVC    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@INVC                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Minimum Order Value                      
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'MINO'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@MINO 40                             
     CSR                   MOVE FRDTAT    T@MINO  1                             
     CSR                   MOVE FREC      E@MINO  1                             
     CSR                   MOVE FRDTAS    C@MINO  40                            
     CSR                   MOVE FRDTAD    G@MINO  10                            
     CSR                   MOVE FRCDEC    F@MINO  1                             
     CSR                   MOVELFRSY      S@MINO  4                             
     CSR                   MOVE FRRT      R@MINO  2                             
     CSR                   MOVE FRDVAL    D@MINO 40                             
     CSR                   MOVE FRVAL     A@MINO 40                             
     CSR                   MOVE FRLVAL    L@MINO 40                             
     CSR                   MOVE FRUVAL    U@MINO 40                             
     CSR                   MOVE FREDWR    W@MINO 30                             
     CSR                   MOVE FRLR      J@MINO  1                             
     CSR                   MOVE FRNNIX    N@MINO  20                            
     CSR                   Z-ADD1         #@MINO 110                            
     CSR                   MOVE F@MINO    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@MINO                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Price Pick List (Y/N)                    
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'PLST'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@PLST 40                             
     CSR                   MOVE FRDTAT    T@PLST  1                             
     CSR                   MOVE FREC      E@PLST  1                             
     CSR                   MOVE FRDTAS    C@PLST  40                            
     CSR                   MOVE FRDTAD    G@PLST  10                            
     CSR                   MOVE FRCDEC    F@PLST  1                             
     CSR                   MOVELFRSY      S@PLST  4                             
     CSR                   MOVE FRRT      R@PLST  2                             
     CSR                   MOVE FRDVAL    D@PLST 40                             
     CSR                   MOVE FRVAL     A@PLST 40                             
     CSR                   MOVE FRLVAL    L@PLST 40                             
     CSR                   MOVE FRUVAL    U@PLST 40                             
     CSR                   MOVE FREDWR    W@PLST 30                             
     CSR                   MOVE FRLR      J@PLST  1                             
     CSR                   MOVE FRNNIX    N@PLST  20                            
     CSR                   Z-ADD1         #@PLST 110                            
     CSR                   MOVE F@PLST    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@PLST                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Priority - Processing                    
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'PRIO'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@PRIO 40                             
     CSR                   MOVE FRDTAT    T@PRIO  1                             
     CSR                   MOVE FREC      E@PRIO  1                             
     CSR                   MOVE FRDTAS    C@PRIO  40                            
     CSR                   MOVE FRDTAD    G@PRIO  10                            
     CSR                   MOVE FRCDEC    F@PRIO  1                             
     CSR                   MOVELFRSY      S@PRIO  4                             
     CSR                   MOVE FRRT      R@PRIO  2                             
     CSR                   MOVE FRDVAL    D@PRIO 40                             
     CSR                   MOVE FRVAL     A@PRIO 40                             
     CSR                   MOVE FRLVAL    L@PRIO 40                             
     CSR                   MOVE FRUVAL    U@PRIO 40                             
     CSR                   MOVE FREDWR    W@PRIO 30                             
     CSR                   MOVE FRLR      J@PRIO  1                             
     CSR                   MOVE FRNNIX    N@PRIO  20                            
     CSR                   Z-ADD1         #@PRIO 110                            
     CSR                   MOVE F@PRIO    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@PRIO                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Route Code                               
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'ROUT'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@ROUT 40                             
     CSR                   MOVE FRDTAT    T@ROUT  1                             
     CSR                   MOVE FREC      E@ROUT  1                             
     CSR                   MOVE FRDTAS    C@ROUT  40                            
     CSR                   MOVE FRDTAD    G@ROUT  10                            
     CSR                   MOVE FRCDEC    F@ROUT  1                             
     CSR                   MOVELFRSY      S@ROUT  4                             
     CSR                   MOVE FRRT      R@ROUT  2                             
     CSR                   MOVE FRDVAL    D@ROUT 40                             
     CSR                   MOVE FRVAL     A@ROUT 40                             
     CSR                   MOVE FRLVAL    L@ROUT 40                             
     CSR                   MOVE FRUVAL    U@ROUT 40                             
     CSR                   MOVE FREDWR    W@ROUT 30                             
     CSR                   MOVE FRLR      J@ROUT  1                             
     CSR                   MOVE FRNNIX    N@ROUT  20                            
     CSR                   Z-ADD1         #@ROUT 110                            
     CSR                   MOVE F@ROUT    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@ROUT                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Substitutes Allowed (Y/N)                
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'SBAL'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@SBAL 40                             
     CSR                   MOVE FRDTAT    T@SBAL  1                             
     CSR                   MOVE FREC      E@SBAL  1                             
     CSR                   MOVE FRDTAS    C@SBAL  40                            
     CSR                   MOVE FRDTAD    G@SBAL  10                            
     CSR                   MOVE FRCDEC    F@SBAL  1                             
     CSR                   MOVELFRSY      S@SBAL  4                             
     CSR                   MOVE FRRT      R@SBAL  2                             
     CSR                   MOVE FRDVAL    D@SBAL 40                             
     CSR                   MOVE FRVAL     A@SBAL 40                             
     CSR                   MOVE FRLVAL    L@SBAL 40                             
     CSR                   MOVE FRUVAL    U@SBAL 40                             
     CSR                   MOVE FREDWR    W@SBAL 30                             
     CSR                   MOVE FRLR      J@SBAL  1                             
     CSR                   MOVE FRNNIX    N@SBAL  20                            
     CSR                   Z-ADD1         #@SBAL 110                            
     CSR                   MOVE F@SBAL    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@SBAL                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Stop Code                                
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'STOP'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@STOP 40                             
     CSR                   MOVE FRDTAT    T@STOP  1                             
     CSR                   MOVE FREC      E@STOP  1                             
     CSR                   MOVE FRDTAS    C@STOP  40                            
     CSR                   MOVE FRDTAD    G@STOP  10                            
     CSR                   MOVE FRCDEC    F@STOP  1                             
     CSR                   MOVELFRSY      S@STOP  4                             
     CSR                   MOVE FRRT      R@STOP  2                             
     CSR                   MOVE FRDVAL    D@STOP 40                             
     CSR                   MOVE FRVAL     A@STOP 40                             
     CSR                   MOVE FRLVAL    L@STOP 40                             
     CSR                   MOVE FRUVAL    U@STOP 40                             
     CSR                   MOVE FREDWR    W@STOP 30                             
     CSR                   MOVE FRLR      J@STOP  1                             
     CSR                   MOVE FRNNIX    N@STOP  20                            
     CSR                   Z-ADD1         #@STOP 110                            
     CSR                   MOVE F@STOP    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@STOP                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Discount - Trade                         
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'TRDC'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@TRDC 40                             
     CSR                   MOVE FRDTAT    T@TRDC  1                             
     CSR                   MOVE FREC      E@TRDC  1                             
     CSR                   MOVE FRDTAS    C@TRDC  40                            
     CSR                   MOVE FRDTAD    G@TRDC  10                            
     CSR                   MOVE FRCDEC    F@TRDC  1                             
     CSR                   MOVELFRSY      S@TRDC  4                             
     CSR                   MOVE FRRT      R@TRDC  2                             
     CSR                   MOVE FRDVAL    D@TRDC 40                             
     CSR                   MOVE FRVAL     A@TRDC 40                             
     CSR                   MOVE FRLVAL    L@TRDC 40                             
     CSR                   MOVE FRUVAL    U@TRDC 40                             
     CSR                   MOVE FREDWR    W@TRDC 30                             
     CSR                   MOVE FRLR      J@TRDC  1                             
     CSR                   MOVE FRNNIX    N@TRDC  20                            
     CSR                   Z-ADD1         #@TRDC 110                            
     CSR                   MOVE F@TRDC    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@TRDC                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Certificate, Tax Exemption               
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'TXCT'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@TXCT 40                             
     CSR                   MOVE FRDTAT    T@TXCT  1                             
     CSR                   MOVE FREC      E@TXCT  1                             
     CSR                   MOVE FRDTAS    C@TXCT  40                            
     CSR                   MOVE FRDTAD    G@TXCT  10                            
     CSR                   MOVE FRCDEC    F@TXCT  1                             
     CSR                   MOVELFRSY      S@TXCT  4                             
     CSR                   MOVE FRRT      R@TXCT  2                             
     CSR                   MOVE FRDVAL    D@TXCT 40                             
     CSR                   MOVE FRVAL     A@TXCT 40                             
     CSR                   MOVE FRLVAL    L@TXCT 40                             
     CSR                   MOVE FRUVAL    U@TXCT 40                             
     CSR                   MOVE FREDWR    W@TXCT 30                             
     CSR                   MOVE FRLR      J@TXCT  1                             
     CSR                   MOVE FRNNIX    N@TXCT  20                            
     CSR                   Z-ADD1         #@TXCT 110                            
     CSR                   MOVE F@TXCT    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@TXCT                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Unit of Measure - Volume Display         
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'VUMD'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@VUMD 40                             
     CSR                   MOVE FRDTAT    T@VUMD  1                             
     CSR                   MOVE FREC      E@VUMD  1                             
     CSR                   MOVE FRDTAS    C@VUMD  40                            
     CSR                   MOVE FRDTAD    G@VUMD  10                            
     CSR                   MOVE FRCDEC    F@VUMD  1                             
     CSR                   MOVELFRSY      S@VUMD  4                             
     CSR                   MOVE FRRT      R@VUMD  2                             
     CSR                   MOVE FRDVAL    D@VUMD 40                             
     CSR                   MOVE FRVAL     A@VUMD 40                             
     CSR                   MOVE FRLVAL    L@VUMD 40                             
     CSR                   MOVE FRUVAL    U@VUMD 40                             
     CSR                   MOVE FREDWR    W@VUMD 30                             
     CSR                   MOVE FRLR      J@VUMD  1                             
     CSR                   MOVE FRNNIX    N@VUMD  20                            
     CSR                   Z-ADD1         #@VUMD 110                            
     CSR                   MOVE F@VUMD    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@VUMD                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Unit of Measure - Weight Display         
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'WUMD'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@WUMD 40                             
     CSR                   MOVE FRDTAT    T@WUMD  1                             
     CSR                   MOVE FREC      E@WUMD  1                             
     CSR                   MOVE FRDTAS    C@WUMD  40                            
     CSR                   MOVE FRDTAD    G@WUMD  10                            
     CSR                   MOVE FRCDEC    F@WUMD  1                             
     CSR                   MOVELFRSY      S@WUMD  4                             
     CSR                   MOVE FRRT      R@WUMD  2                             
     CSR                   MOVE FRDVAL    D@WUMD 40                             
     CSR                   MOVE FRVAL     A@WUMD 40                             
     CSR                   MOVE FRLVAL    L@WUMD 40                             
     CSR                   MOVE FRUVAL    U@WUMD 40                             
     CSR                   MOVE FREDWR    W@WUMD 30                             
     CSR                   MOVE FRLR      J@WUMD  1                             
     CSR                   MOVE FRNNIX    N@WUMD  20                            
     CSR                   Z-ADD1         #@WUMD 110                            
     CSR                   MOVE F@WUMD    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@WUMD                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Zone Number                              
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'ZON'     FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@ZON  40                             
     CSR                   MOVE FRDTAT    T@ZON   1                             
     CSR                   MOVE FREC      E@ZON   1                             
     CSR                   MOVE FRDTAS    C@ZON   40                            
     CSR                   MOVE FRDTAD    G@ZON   10                            
     CSR                   MOVE FRCDEC    F@ZON   1                             
     CSR                   MOVELFRSY      S@ZON   4                             
     CSR                   MOVE FRRT      R@ZON   2                             
     CSR                   MOVE FRDVAL    D@ZON  40                             
     CSR                   MOVE FRVAL     A@ZON  40                             
     CSR                   MOVE FRLVAL    L@ZON  40                             
     CSR                   MOVE FRUVAL    U@ZON  40                             
     CSR                   MOVE FREDWR    W@ZON  30                             
     CSR                   MOVE FRLR      J@ZON   1                             
     CSR                   MOVE FRNNIX    N@ZON   20                            
     CSR                   Z-ADD1         #@ZON  110                            
     CSR                   MOVE F@ZON     #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@ZON                                 
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Maximum Order Value                      
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'MAXO'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@MAXO 40                             
     CSR                   MOVE FRDTAT    T@MAXO  1                             
     CSR                   MOVE FREC      E@MAXO  1                             
     CSR                   MOVE FRDTAS    C@MAXO  40                            
     CSR                   MOVE FRDTAD    G@MAXO  10                            
     CSR                   MOVE FRCDEC    F@MAXO  1                             
     CSR                   MOVELFRSY      S@MAXO  4                             
     CSR                   MOVE FRRT      R@MAXO  2                             
     CSR                   MOVE FRDVAL    D@MAXO 40                             
     CSR                   MOVE FRVAL     A@MAXO 40                             
     CSR                   MOVE FRLVAL    L@MAXO 40                             
     CSR                   MOVE FRUVAL    U@MAXO 40                             
     CSR                   MOVE FREDWR    W@MAXO 30                             
     CSR                   MOVE FRLR      J@MAXO  1                             
     CSR                   MOVE FRNNIX    N@MAXO  20                            
     CSR                   Z-ADD1         #@MAXO 110                            
     CSR                   MOVE F@MAXO    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@MAXO                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Batch Processing Mode                    
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'EDPM'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@EDPM 40                             
     CSR                   MOVE FRDTAT    T@EDPM  1                             
     CSR                   MOVE FREC      E@EDPM  1                             
     CSR                   MOVE FRDTAS    C@EDPM  40                            
     CSR                   MOVE FRDTAD    G@EDPM  10                            
     CSR                   MOVE FRCDEC    F@EDPM  1                             
     CSR                   MOVELFRSY      S@EDPM  4                             
     CSR                   MOVE FRRT      R@EDPM  2                             
     CSR                   MOVE FRDVAL    D@EDPM 40                             
     CSR                   MOVE FRVAL     A@EDPM 40                             
     CSR                   MOVE FRLVAL    L@EDPM 40                             
     CSR                   MOVE FRUVAL    U@EDPM 40                             
     CSR                   MOVE FREDWR    W@EDPM 30                             
     CSR                   MOVE FRLR      J@EDPM  1                             
     CSR                   MOVE FRNNIX    N@EDPM  20                            
     CSR                   Z-ADD1         #@EDPM 110                            
     CSR                   MOVE F@EDPM    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@EDPM                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Customer Type Identifier                 
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'EDCI'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@EDCI 40                             
     CSR                   MOVE FRDTAT    T@EDCI  1                             
     CSR                   MOVE FREC      E@EDCI  1                             
     CSR                   MOVE FRDTAS    C@EDCI  40                            
     CSR                   MOVE FRDTAD    G@EDCI  10                            
     CSR                   MOVE FRCDEC    F@EDCI  1                             
     CSR                   MOVELFRSY      S@EDCI  4                             
     CSR                   MOVE FRRT      R@EDCI  2                             
     CSR                   MOVE FRDVAL    D@EDCI 40                             
     CSR                   MOVE FRVAL     A@EDCI 40                             
     CSR                   MOVE FRLVAL    L@EDCI 40                             
     CSR                   MOVE FRUVAL    U@EDCI 40                             
     CSR                   MOVE FREDWR    W@EDCI 30                             
     CSR                   MOVE FRLR      J@EDCI  1                             
     CSR                   MOVE FRNNIX    N@EDCI  20                            
     CSR                   Z-ADD1         #@EDCI 110                            
     CSR                   MOVE F@EDCI    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@EDCI                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Item Type Identifier                     
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'EDII'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@EDII 40                             
     CSR                   MOVE FRDTAT    T@EDII  1                             
     CSR                   MOVE FREC      E@EDII  1                             
     CSR                   MOVE FRDTAS    C@EDII  40                            
     CSR                   MOVE FRDTAD    G@EDII  10                            
     CSR                   MOVE FRCDEC    F@EDII  1                             
     CSR                   MOVELFRSY      S@EDII  4                             
     CSR                   MOVE FRRT      R@EDII  2                             
     CSR                   MOVE FRDVAL    D@EDII 40                             
     CSR                   MOVE FRVAL     A@EDII 40                             
     CSR                   MOVE FRLVAL    L@EDII 40                             
     CSR                   MOVE FRUVAL    U@EDII 40                             
     CSR                   MOVE FREDWR    W@EDII 30                             
     CSR                   MOVE FRLR      J@EDII  1                             
     CSR                   MOVE FRNNIX    N@EDII  20                            
     CSR                   Z-ADD1         #@EDII 110                            
     CSR                   MOVE F@EDII    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@EDII                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Quantity Decimals                        
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'EDQD'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@EDQD 40                             
     CSR                   MOVE FRDTAT    T@EDQD  1                             
     CSR                   MOVE FREC      E@EDQD  1                             
     CSR                   MOVE FRDTAS    C@EDQD  40                            
     CSR                   MOVE FRDTAD    G@EDQD  10                            
     CSR                   MOVE FRCDEC    F@EDQD  1                             
     CSR                   MOVELFRSY      S@EDQD  4                             
     CSR                   MOVE FRRT      R@EDQD  2                             
     CSR                   MOVE FRDVAL    D@EDQD 40                             
     CSR                   MOVE FRVAL     A@EDQD 40                             
     CSR                   MOVE FRLVAL    L@EDQD 40                             
     CSR                   MOVE FRUVAL    U@EDQD 40                             
     CSR                   MOVE FREDWR    W@EDQD 30                             
     CSR                   MOVE FRLR      J@EDQD  1                             
     CSR                   MOVE FRNNIX    N@EDQD  20                            
     CSR                   Z-ADD1         #@EDQD 110                            
     CSR                   MOVE F@EDQD    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@EDQD                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Amount Decimals                          
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'EDAD'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@EDAD 40                             
     CSR                   MOVE FRDTAT    T@EDAD  1                             
     CSR                   MOVE FREC      E@EDAD  1                             
     CSR                   MOVE FRDTAS    C@EDAD  40                            
     CSR                   MOVE FRDTAD    G@EDAD  10                            
     CSR                   MOVE FRCDEC    F@EDAD  1                             
     CSR                   MOVELFRSY      S@EDAD  4                             
     CSR                   MOVE FRRT      R@EDAD  2                             
     CSR                   MOVE FRDVAL    D@EDAD 40                             
     CSR                   MOVE FRVAL     A@EDAD 40                             
     CSR                   MOVE FRLVAL    L@EDAD 40                             
     CSR                   MOVE FRUVAL    U@EDAD 40                             
     CSR                   MOVE FREDWR    W@EDAD 30                             
     CSR                   MOVE FRLR      J@EDAD  1                             
     CSR                   MOVE FRNNIX    N@EDAD  20                            
     CSR                   Z-ADD1         #@EDAD 110                            
     CSR                   MOVE F@EDAD    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@EDAD                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Dictionary parameters for - Allow partial order shipments            
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'SI01'    FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
B2   CSR         FRERR     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@SI01 40                             
     CSR                   MOVE FRDTAT    T@SI01  1                             
     CSR                   MOVE FREC      E@SI01  1                             
     CSR                   MOVE FRDTAS    C@SI01  40                            
     CSR                   MOVE FRDTAD    G@SI01  10                            
     CSR                   MOVE FRCDEC    F@SI01  1                             
     CSR                   MOVELFRSY      S@SI01  4                             
     CSR                   MOVE FRRT      R@SI01  2                             
     CSR                   MOVE FRDVAL    D@SI01 40                             
     CSR                   MOVE FRVAL     A@SI01 40                             
     CSR                   MOVE FRLVAL    L@SI01 40                             
     CSR                   MOVE FRUVAL    U@SI01 40                             
     CSR                   MOVE FREDWR    W@SI01 30                             
     CSR                   MOVE FRLR      J@SI01  1                             
     CSR                   MOVE FRNNIX    N@SI01  20                            
     CSR                   Z-ADD1         #@SI01 110                            
     CSR                   MOVE F@SI01    #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@SI01                                
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Set subroutine execution flag.                                       
     C*                                                                         
     CSR                   MOVE '1'       $998    1                             
     C*----------------------------------------------------------------         
\\\  CSR         END998    ENDSR                                                
     C*****************************************************************         
     C*                                                                         
     C*    SUBROUTINE S999  - Housekeeping                                      
     C*    -------------------------------                                      
     C*                                                                         
     C*    Processing:  1.  Load video screen text.                             
     C*                 2.  Retrieve screen title data area, test               
     C*                     for unauthorized access, center video               
     C*                     title and move to video screen.                     
     C*                 3.  Initialize key list.                                
     C*                 4.  Load roll keys.                                     
     C*                 5.  Passed parameters.                                  
     C*                 6.  Load error message array.                           
     C*                                                                         
     CSR         S999      BEGSR                                                
     C*          ----      -----                                                
     C*                                                                         
     C*    Required program parameters.                                         
     C*                                                                         
     CSR         *ENTRY    PLIST                                                
     CSR                   PARM           $AN8    80                            
     C*                                                                         
B1   CSR         $AN8      IFNE 0                                               
     C*                                                                         
     C*    If parameter is positive, execute inqiury/change cycle               
     C*                                                                         
B2   CSR         $AN8      IFGT 0                                               
     CSR                   MOVE '1'       $AUTO   1                             
     CSR                   MOVE 'I'       @@PACT  1                             
     CSR                   MOVE 'C'       ACTION                                
E2   CSR                   ENDIF                                                
     C*                                                                         
     C*    If parameter is negative, execute add cycle                          
     C*                                                                         
B2   CSR         $AN8      IFLT 0                                               
     CSR                   MOVE ' '       $AUTO   1                             
     CSR                   MOVE ' '       @@PACT  1                             
     CSR                   MOVE 'A'       ACTION                                
E2   CSR                   ENDIF                                                
     C*                                                                         
     C*    Load display fields                                                  
     C*                                                                         
     C*    Dictionary parameters for - Address Number                           
     C*                                                                         
     CSR                   MOVE *BLANK    FRDTAI                                
     CSR                   MOVEL'AN8'     FRDTAI                                
     CSR                   CALL 'X9800E'               81                       
     C*                    ---- --------                                        
     CSR                   PARM           I9800E                                
     CSR                   MOVE FRERR     *IN81                                 
B2   CSR         *IN81     IFEQ '0'                                             
     CSR                   MOVE FRDSCR    B@AN8  40                             
     CSR                   MOVE FRDTAT    T@AN8   1                             
     CSR                   MOVE FREC      E@AN8   1                             
     CSR                   MOVE FRDTAS    C@AN8   40                            
     CSR                   MOVE FRDTAD    G@AN8   10                            
     CSR                   MOVE FRCDEC    F@AN8   1                             
     CSR                   MOVELFRSY      S@AN8   4                             
     CSR                   MOVE FRRT      R@AN8   2                             
     CSR                   MOVE FRDVAL    D@AN8  40                             
     CSR                   MOVE FRVAL     A@AN8  40                             
     CSR                   MOVE FRLVAL    L@AN8  40                             
     CSR                   MOVE FRUVAL    U@AN8  40                             
     CSR                   MOVE FREDWR    W@AN8  30                             
     CSR                   MOVE FRLR      J@AN8   1                             
     CSR                   MOVE FRNNIX    N@AN8   20                            
     CSR                   Z-ADD1         #@AN8  110                            
     CSR                   MOVE F@AN8     #A                                    
B3   CSR                   DO   #A                                              
     CSR                   MULT 10        #@AN8                                 
E3   CSR                   ENDDO                                                
E2   CSR                   ENDIF                                                
     C*                                                                         
     CSR                   MOVE *BLANK    #SINBR                                
     CSR                   MOVEL$AN8      #SINBR                                
     CSR                   MOVE T@AN8     #DTYP                                 
     CSR                   MOVE W@AN8     #EWRD                                 
     CSR                   MOVE E@AN8     #EC                                   
     CSR                   MOVE F@AN8     #DSPD                                 
     CSR                   MOVE G@AN8     #DATD                                 
     CSR                   MOVE J@AN8     #ALR                                  
     CSR                   MOVE ' '       #ECOR                                 
     CSR                   MOVE ' '       #DCOR                                 
     CSR                   EXSR C00161                                          
     C*                    ---- ------                                          
B2   CSR         #ALR      IFEQ 'L'                                             
     CSR                   MOVEL#SINBR    VDAN8                                 
X2   CSR                   ELSE                                                 
     CSR                   MOVE #SINBR    VDAN8                                 
E2   CSR                   ENDIF                                                
E1   CSR                   ENDIF                                                
     CSR                   Z-ADD0         $ADD#   80                            
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Load soft coded screen text file key                                 
     C*                                                                         
     CSR                   MOVEL'V4206   'PSKEY  10                             
     CSR                   Z-ADD45        PSVTX#                                
     C/COPY JDECPY,C00SC                                                        
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Key list for - LF - Address Number                                   
     C*                                                                         
     CSR         ABKY0A    KLIST                                                
     CSR                   KFLD           ABAN8                                 
     C*                                                                         
S6195CSR         KEY01     KLIST                                                
S6195CSR                   KFLD           SY01                                  
S6195CSR                   KFLD           RT01                                  
S6195CSR                   KFLD           KY01                                  
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Define and initialize save field.                                    
     C*                                                                         
     CSR         *LIKE     DEFN A5AN8     $SAN8                                 
     CSR                   Z-ADD*ZEROS    $SAN8                                 
     C*                                                                         
     C*    Load roll key upper and lower key values.                            
     C*                                                                         
     CSR         *LIKE     DEFN A5AN8     $RUKEY                                
     CSR         *LIKE     DEFN $RUKEY    $RDKEY                                
     CSR                   MOVE *LOVAL    $RUKEY                                
     CSR                   MOVE *ALL'9'   $RDKEY                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Load error messages array.                                           
     C*                                                                         
     CSR                   MOVE '0001'    EMK,01           Inv Action           
     CSR                   MOVE '0002'    EMK,02           Inv Key              
     CSR                   MOVE '0003'    EMK,03           Inv Blanks           
     CSR                   MOVE '0004'    EMK,04           Inv Date             
     CSR                   MOVE '0005'    EMK,05           Inv Next Nbr         
     CSR                   MOVE '0007'    EMK,06           In Use               
     CSR                   MOVE '0025'    EMK,07           Inv Values           
     CSR                   MOVE '0026'    EMK,08           Inv MCU              
     CSR                   MOVE '0027'    EMK,09           Inv Desc Ttl         
     CSR                   MOVE '0504'    EMK,10           Inv Desc Ttl         
     CSR                   MOVE '0272'    EMK,11           Inv Desc Ttl         
     CSR                   MOVE '4601'    EMK,12           Order Template       
     CSR                   MOVE '3490'    EMK,13           F0301 Missing        
14329CSR                   MOVE '5614'    EMK,14           Day is invalid       
14329CSR                   MOVE '5615'    EMK,15           VMI reference        
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Load invalid action code array.                                      
     C*                                                                         
     CSR                   MOVEA'  X  '   @NAC                                  
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Load system date.                                                    
     C*                                                                         
     CSR                   TIME           $WRK12 120                            
     CSR                   MOVE $WRK12    $$EDT   60                            
     CSR                   MOVEL$WRK12    $TDAY   60                            
     C*                                                                         
     CSR                   MOVE $$EDT     #SIDAT  6                             
     CSR                   MOVE *BLANK    #EDAT   8                             
     CSR                   MOVEL'*SYSVAL '#FFMT   7                             
     CSR                   MOVEL'*JUL    '#TFMT   7                             
     CSR                   MOVEL'*NONE   '#SEP    7                             
     CSR                   MOVEL' '       $ERTST  1                             
     CSR                   CALL 'X0028   '             99                       
     C*                    ---- ----------                                      
     CSR                   PARM           #SIDAT                                
     CSR                   PARM           #EDAT                                 
     CSR                   PARM           #FFMT                                 
     CSR                   PARM           #TFMT                                 
     CSR                   PARM           #SEP                                  
     CSR                   PARM           $ERTST                                
     CSR                   MOVEL#SIDAT    $$UPMJ  60                            
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Load Advanced Pricing Flag from System Constants.                    
     C*                                                                         
     CSR                   SETOF                     26                         
     CSR                   MOVE *BLANKS   PS@@                                  
     CSR                   MOVEL*BLANKS   KY@@                                  
     CSR                   CALL 'XS4009'               81                       
     C*                    ---- ---------                                       
     CSR                   PARM           PS@@                                  
     CSR                   PARM           DS4009                                
B1   CSR         RT@@      IFNE 'N'                                             
     CSR         CPADVP    ANDEQ'Y'                                             
     CSR                   SETON                     26                         
E1   CSR                   ENDIF                                                
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Load Complementary products constants.                               
     C*                                                                         
     CSR                   CLEARDSCOMP                                          
     CSR                   MOVE *BLANKS   PS@@                                  
     CSR                   MOVEL*BLANKS   KY@@                                  
     CSR                   CALL 'XS7300'               81                       
     C*                    ---- ---------                                       
     CSR                   PARM           PS@@                                  
     CSR                   PARM           DSCOMP                                
     C*                                                                         
     C*    Set default interface values.                                        
     C*                                                                         
     CSR         *IN81     IFEQ *ON                                             
     CSR                   MOVE *ALL'0'   DSCOMP                                
     CSR                   ENDIF                                                
     C*                                                                         
     C*    Load SMS System constants.                                           
     C*                                                                         
     CSR                   MOVE #CASMS    $@ASMS  1                             
     C*----------------------------------------------------------------         
     C*                                                                         
     C*    Initialize variables.                                                
     C*                                                                         
     CSR                   MOVEL'A71     '@@FMT                                 
     C*----------------------------------------------------------------         
     CSR         END999    ENDSR                                                
     C*****************************************************************         
